"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ghl-contact/route";
exports.ids = ["app/api/ghl-contact/route"];
exports.modules = {

/***/ "jsdom":
/*!************************!*\
  !*** external "jsdom" ***!
  \************************/
/***/ ((module) => {

module.exports = require("jsdom");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "module":
/*!*************************!*\
  !*** external "module" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("module");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:diagnostics_channel":
/*!*******************************************!*\
  !*** external "node:diagnostics_channel" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = require("node:diagnostics_channel");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:events");

/***/ }),

/***/ "node:os":
/*!**************************!*\
  !*** external "node:os" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:os");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fghl-contact%2Froute&page=%2Fapi%2Fghl-contact%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fghl-contact%2Froute.ts&appDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fghl-contact%2Froute&page=%2Fapi%2Fghl-contact%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fghl-contact%2Froute.ts&appDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_20015_Downloads_aligned_chiro_nextgen_assessment_app_api_ghl_contact_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ghl-contact/route.ts */ \"(rsc)/./app/api/ghl-contact/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ghl-contact/route\",\n        pathname: \"/api/ghl-contact\",\n        filename: \"route\",\n        bundlePath: \"app/api/ghl-contact/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\20015\\\\Downloads\\\\aligned-chiro---nextgen-assessment\\\\app\\\\api\\\\ghl-contact\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_20015_Downloads_aligned_chiro_nextgen_assessment_app_api_ghl_contact_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ghl-contact/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnaGwtY29udGFjdCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZ2hsLWNvbnRhY3QlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZnaGwtY29udGFjdCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUMyMDAxNSU1Q0Rvd25sb2FkcyU1Q2FsaWduZWQtY2hpcm8tLS1uZXh0Z2VuLWFzc2Vzc21lbnQlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1QzIwMDE1JTVDRG93bmxvYWRzJTVDYWxpZ25lZC1jaGlyby0tLW5leHRnZW4tYXNzZXNzbWVudCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDZ0Q7QUFDN0g7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbGlnbmVkLWNoaXJvLS0tbmV4dGdlbi1hc3Nlc3NtZW50Lz9jYWRkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXDIwMDE1XFxcXERvd25sb2Fkc1xcXFxhbGlnbmVkLWNoaXJvLS0tbmV4dGdlbi1hc3Nlc3NtZW50XFxcXGFwcFxcXFxhcGlcXFxcZ2hsLWNvbnRhY3RcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dobC1jb250YWN0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2hsLWNvbnRhY3RcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2dobC1jb250YWN0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcMjAwMTVcXFxcRG93bmxvYWRzXFxcXGFsaWduZWQtY2hpcm8tLS1uZXh0Z2VuLWFzc2Vzc21lbnRcXFxcYXBwXFxcXGFwaVxcXFxnaGwtY29udGFjdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZ2hsLWNvbnRhY3Qvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fghl-contact%2Froute&page=%2Fapi%2Fghl-contact%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fghl-contact%2Froute.ts&appDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ghl-contact/route.ts":
/*!**************************************!*\
  !*** ./app/api/ghl-contact/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! isomorphic-dompurify */ \"(rsc)/./node_modules/isomorphic-dompurify/index.js\");\n/* harmony import */ var isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! nanoid */ \"(rsc)/./node_modules/nanoid/index.js\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./lib/logger.ts\");\n/* harmony import */ var _lib_rateLimiter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/rateLimiter */ \"(rsc)/./lib/rateLimiter.ts\");\n/* harmony import */ var _lib_requestSigner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/requestSigner */ \"(rsc)/./lib/requestSigner.ts\");\n/* harmony import */ var _lib_botDetection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/botDetection */ \"(rsc)/./lib/botDetection.ts\");\n/* harmony import */ var _lib_ghlService__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/ghlService */ \"(rsc)/./lib/ghlService.ts\");\n\n\n\n\n\n\n\n\n\n// Validation schema\nconst contactSchema = zod__WEBPACK_IMPORTED_MODULE_7__.object({\n    firstName: zod__WEBPACK_IMPORTED_MODULE_7__.string().min(1).max(50),\n    lastName: zod__WEBPACK_IMPORTED_MODULE_7__.string().min(1).max(50),\n    email: zod__WEBPACK_IMPORTED_MODULE_7__.string().email().max(100),\n    phone: zod__WEBPACK_IMPORTED_MODULE_7__.string().min(8).max(20),\n    postcode: zod__WEBPACK_IMPORTED_MODULE_7__.string().min(3).max(10),\n    occupancyStatus: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    heatingType: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    professionalSituation: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    projectType: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    surfaceArea: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    houseAge: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    timeline: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    // Security fields\n    website_url: zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),\n    timestamp: zod__WEBPACK_IMPORTED_MODULE_7__.number(),\n    startTime: zod__WEBPACK_IMPORTED_MODULE_7__.number(),\n    signature: zod__WEBPACK_IMPORTED_MODULE_7__.string()\n});\nasync function POST(request) {\n    const correlationId = (0,nanoid__WEBPACK_IMPORTED_MODULE_8__.nanoid)();\n    const startTime = Date.now();\n    try {\n        // Get client IP\n        const ip = request.headers.get(\"x-forwarded-for\")?.split(\",\")[0] || request.headers.get(\"x-real-ip\") || \"unknown\";\n        _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].info({\n            correlationId,\n            ip\n        }, \"Received form submission\");\n        // Check request size (10KB max)\n        const contentLength = request.headers.get(\"content-length\");\n        if (contentLength && parseInt(contentLength) > 10240) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                contentLength\n            }, \"Request too large\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Request too large\"\n            }, {\n                status: 413\n            });\n        }\n        // Parse body\n        let body;\n        try {\n            body = await request.json();\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId\n            }, \"Invalid JSON\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid request\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate schema\n        const validationResult = contactSchema.safeParse(body);\n        if (!validationResult.success) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                errors: validationResult.error.issues\n            }, \"Validation failed\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid form data\"\n            }, {\n                status: 400\n            });\n        }\n        const data = validationResult.data;\n        // Bot Detection Layer 1: Honeypot\n        if ((0,_lib_botDetection__WEBPACK_IMPORTED_MODULE_5__.checkHoneypot)(data.website_url)) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId\n            }, \"Bot detected: honeypot filled\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid submission\"\n            }, {\n                status: 400\n            });\n        }\n        // Bot Detection Layer 2: Timing\n        if (!(0,_lib_botDetection__WEBPACK_IMPORTED_MODULE_5__.checkSubmissionTiming)(data.startTime)) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                startTime: data.startTime\n            }, \"Bot detected: invalid timing\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid submission\"\n            }, {\n                status: 400\n            });\n        }\n        // Bot Detection Layer 3: User-Agent\n        const userAgent = request.headers.get(\"user-agent\");\n        if ((0,_lib_botDetection__WEBPACK_IMPORTED_MODULE_5__.detectBot)(userAgent)) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                userAgent\n            }, \"Bot detected: user-agent\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid submission\"\n            }, {\n                status: 400\n            });\n        }\n        // Bot Detection Layer 4: HMAC Signature\n        // Exclude website_url (honeypot) from the signed payload\n        const { signature, timestamp, website_url, ...formDataWithStartTime } = data;\n        const verificationResult = (0,_lib_requestSigner__WEBPACK_IMPORTED_MODULE_4__.verifyRequest)(formDataWithStartTime, signature, timestamp);\n        if (!verificationResult.valid) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                error: verificationResult.error,\n                receivedSignature: signature,\n                receivedTimestamp: timestamp,\n                formDataKeys: Object.keys(formDataWithStartTime)\n            }, \"Invalid signature\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid request signature\"\n            }, {\n                status: 401\n            });\n        }\n        // Sanitize inputs\n        const sanitizedData = {\n            firstName: isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_1___default().sanitize(data.firstName.trim()),\n            lastName: isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_1___default().sanitize(data.lastName.trim()),\n            email: data.email.toLowerCase().trim(),\n            phone: data.phone.replace(/\\D/g, \"\"),\n            postcode: isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_1___default().sanitize(data.postcode.trim()),\n            quizData: {\n                occupancyStatus: data.occupancyStatus || \"\",\n                heatingType: data.heatingType || \"\",\n                professionalSituation: data.professionalSituation || \"\",\n                projectType: data.projectType || \"\",\n                surfaceArea: data.surfaceArea || \"\",\n                houseAge: data.houseAge || \"\",\n                timeline: data.timeline || \"\"\n            }\n        };\n        // Rate Limiting Layer 1: IP-based\n        const ipLimit = _lib_rateLimiter__WEBPACK_IMPORTED_MODULE_3__[\"default\"].checkIPLimit(ip);\n        if (!ipLimit.allowed) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                ip,\n                retryAfter: ipLimit.retryAfter\n            }, \"Rate limit exceeded: IP\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Too many requests\"\n            }, {\n                status: 429,\n                headers: {\n                    \"Retry-After\": ipLimit.retryAfter?.toString() || \"900\"\n                }\n            });\n        }\n        // Rate Limiting Layer 2: Email-based\n        const emailLimit = _lib_rateLimiter__WEBPACK_IMPORTED_MODULE_3__[\"default\"].checkEmailLimit(sanitizedData.email);\n        if (!emailLimit.allowed) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].warn({\n                correlationId,\n                email: sanitizedData.email,\n                retryAfter: emailLimit.retryAfter\n            }, \"Rate limit exceeded: Email\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Too many requests\"\n            }, {\n                status: 429,\n                headers: {\n                    \"Retry-After\": emailLimit.retryAfter?.toString() || \"3600\"\n                }\n            });\n        }\n        // Check if contact already exists\n        _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].info({\n            correlationId\n        }, \"Checking if contact exists\");\n        const existingContact = await _lib_ghlService__WEBPACK_IMPORTED_MODULE_6__[\"default\"].contactExists(sanitizedData.email, sanitizedData.phone, correlationId);\n        if (existingContact) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].info({\n                correlationId,\n                contactId: existingContact.id\n            }, \"Contact already exists, skipping creation\");\n            // Return success but don't create duplicate\n            const duration = Date.now() - startTime;\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].info({\n                correlationId,\n                duration\n            }, \"Request completed (existing contact)\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: \"Thank you for your submission\"\n            });\n        }\n        // Create new contact with website_lead tag\n        _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].info({\n            correlationId\n        }, \"Creating new contact\");\n        const newContact = await _lib_ghlService__WEBPACK_IMPORTED_MODULE_6__[\"default\"].createContact(sanitizedData, correlationId);\n        const duration = Date.now() - startTime;\n        _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].info({\n            correlationId,\n            contactId: newContact.id,\n            duration\n        }, \"Contact created successfully\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: \"Thank you for your submission\"\n        });\n    } catch (error) {\n        const duration = Date.now() - startTime;\n        _lib_logger__WEBPACK_IMPORTED_MODULE_2__[\"default\"].error({\n            correlationId,\n            error: error.message,\n            duration\n        }, \"Error processing form submission\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"An error occurred processing your submission\"\n        }, {\n            status: 500\n        });\n    }\n}\n// Handle OPTIONS for CORS preflight\nasync function OPTIONS(request) {\n    const allowedOrigins = process.env.ALLOWED_ORIGINS?.split(\",\") || [];\n    const origin = request.headers.get(\"origin\") || \"\";\n    const isAllowed = allowedOrigins.includes(origin) || \"development\" === \"development\";\n    if (!isAllowed) {\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n            status: 403\n        });\n    }\n    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200,\n        headers: {\n            \"Access-Control-Allow-Origin\": origin,\n            \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type\",\n            \"Access-Control-Max-Age\": \"86400\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2dobC1jb250YWN0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUF3RDtBQUNoQztBQUNxQjtBQUNiO0FBQ0U7QUFDVTtBQUNRO0FBQ2lDO0FBQzNDO0FBRTFDLG9CQUFvQjtBQUNwQixNQUFNVyxnQkFBZ0JWLHVDQUFRLENBQUM7SUFDM0JZLFdBQVdaLHVDQUFRLEdBQUdjLEdBQUcsQ0FBQyxHQUFHQyxHQUFHLENBQUM7SUFDakNDLFVBQVVoQix1Q0FBUSxHQUFHYyxHQUFHLENBQUMsR0FBR0MsR0FBRyxDQUFDO0lBQ2hDRSxPQUFPakIsdUNBQVEsR0FBR2lCLEtBQUssR0FBR0YsR0FBRyxDQUFDO0lBQzlCRyxPQUFPbEIsdUNBQVEsR0FBR2MsR0FBRyxDQUFDLEdBQUdDLEdBQUcsQ0FBQztJQUM3QkksVUFBVW5CLHVDQUFRLEdBQUdjLEdBQUcsQ0FBQyxHQUFHQyxHQUFHLENBQUM7SUFDaENLLGlCQUFpQnBCLHVDQUFRLEdBQUdxQixRQUFRO0lBQ3BDQyxhQUFhdEIsdUNBQVEsR0FBR3FCLFFBQVE7SUFDaENFLHVCQUF1QnZCLHVDQUFRLEdBQUdxQixRQUFRO0lBQzFDRyxhQUFheEIsdUNBQVEsR0FBR3FCLFFBQVE7SUFDaENJLGFBQWF6Qix1Q0FBUSxHQUFHcUIsUUFBUTtJQUNoQ0ssVUFBVTFCLHVDQUFRLEdBQUdxQixRQUFRO0lBQzdCTSxVQUFVM0IsdUNBQVEsR0FBR3FCLFFBQVE7SUFDN0Isa0JBQWtCO0lBQ2xCTyxhQUFhNUIsdUNBQVEsR0FBR3FCLFFBQVE7SUFDaENRLFdBQVc3Qix1Q0FBUTtJQUNuQitCLFdBQVcvQix1Q0FBUTtJQUNuQmdDLFdBQVdoQyx1Q0FBUTtBQUN2QjtBQUVPLGVBQWVpQyxLQUFLQyxPQUFvQjtJQUMzQyxNQUFNQyxnQkFBZ0JqQyw4Q0FBTUE7SUFDNUIsTUFBTTZCLFlBQVlLLEtBQUtDLEdBQUc7SUFFMUIsSUFBSTtRQUNBLGdCQUFnQjtRQUNoQixNQUFNQyxLQUFLSixRQUFRSyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0JDLE1BQU0sSUFBSSxDQUFDLEVBQUUsSUFDNURQLFFBQVFLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGdCQUNwQjtRQUVKckMsbURBQU1BLENBQUN1QyxJQUFJLENBQUM7WUFBRVA7WUFBZUc7UUFBRyxHQUFHO1FBRW5DLGdDQUFnQztRQUNoQyxNQUFNSyxnQkFBZ0JULFFBQVFLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQzFDLElBQUlHLGlCQUFpQkMsU0FBU0QsaUJBQWlCLE9BQU87WUFDbER4QyxtREFBTUEsQ0FBQzBDLElBQUksQ0FBQztnQkFBRVY7Z0JBQWVRO1lBQWMsR0FBRztZQUM5QyxPQUFPNUMscURBQVlBLENBQUMrQyxJQUFJLENBQ3BCO2dCQUFFQyxPQUFPO1lBQW9CLEdBQzdCO2dCQUFFQyxRQUFRO1lBQUk7UUFFdEI7UUFFQSxhQUFhO1FBQ2IsSUFBSUM7UUFDSixJQUFJO1lBQ0FBLE9BQU8sTUFBTWYsUUFBUVksSUFBSTtRQUM3QixFQUFFLE9BQU9DLE9BQU87WUFDWjVDLG1EQUFNQSxDQUFDMEMsSUFBSSxDQUFDO2dCQUFFVjtZQUFjLEdBQUc7WUFDL0IsT0FBT3BDLHFEQUFZQSxDQUFDK0MsSUFBSSxDQUNwQjtnQkFBRUMsT0FBTztZQUFrQixHQUMzQjtnQkFBRUMsUUFBUTtZQUFJO1FBRXRCO1FBRUEsa0JBQWtCO1FBQ2xCLE1BQU1FLG1CQUFtQnhDLGNBQWN5QyxTQUFTLENBQUNGO1FBQ2pELElBQUksQ0FBQ0MsaUJBQWlCRSxPQUFPLEVBQUU7WUFDM0JqRCxtREFBTUEsQ0FBQzBDLElBQUksQ0FBQztnQkFBRVY7Z0JBQWVrQixRQUFRSCxpQkFBaUJILEtBQUssQ0FBQ08sTUFBTTtZQUFDLEdBQUc7WUFDdEUsT0FBT3ZELHFEQUFZQSxDQUFDK0MsSUFBSSxDQUNwQjtnQkFBRUMsT0FBTztZQUFvQixHQUM3QjtnQkFBRUMsUUFBUTtZQUFJO1FBRXRCO1FBRUEsTUFBTU8sT0FBT0wsaUJBQWlCSyxJQUFJO1FBRWxDLGtDQUFrQztRQUNsQyxJQUFJaEQsZ0VBQWFBLENBQUNnRCxLQUFLM0IsV0FBVyxHQUFHO1lBQ2pDekIsbURBQU1BLENBQUMwQyxJQUFJLENBQUM7Z0JBQUVWO1lBQWMsR0FBRztZQUMvQixPQUFPcEMscURBQVlBLENBQUMrQyxJQUFJLENBQ3BCO2dCQUFFQyxPQUFPO1lBQXFCLEdBQzlCO2dCQUFFQyxRQUFRO1lBQUk7UUFFdEI7UUFFQSxnQ0FBZ0M7UUFDaEMsSUFBSSxDQUFDeEMsd0VBQXFCQSxDQUFDK0MsS0FBS3hCLFNBQVMsR0FBRztZQUN4QzVCLG1EQUFNQSxDQUFDMEMsSUFBSSxDQUFDO2dCQUFFVjtnQkFBZUosV0FBV3dCLEtBQUt4QixTQUFTO1lBQUMsR0FBRztZQUMxRCxPQUFPaEMscURBQVlBLENBQUMrQyxJQUFJLENBQ3BCO2dCQUFFQyxPQUFPO1lBQXFCLEdBQzlCO2dCQUFFQyxRQUFRO1lBQUk7UUFFdEI7UUFFQSxvQ0FBb0M7UUFDcEMsTUFBTVEsWUFBWXRCLFFBQVFLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQ3RDLElBQUlsQyw0REFBU0EsQ0FBQ2tELFlBQVk7WUFDdEJyRCxtREFBTUEsQ0FBQzBDLElBQUksQ0FBQztnQkFBRVY7Z0JBQWVxQjtZQUFVLEdBQUc7WUFDMUMsT0FBT3pELHFEQUFZQSxDQUFDK0MsSUFBSSxDQUNwQjtnQkFBRUMsT0FBTztZQUFxQixHQUM5QjtnQkFBRUMsUUFBUTtZQUFJO1FBRXRCO1FBRUEsd0NBQXdDO1FBQ3hDLHlEQUF5RDtRQUN6RCxNQUFNLEVBQUVoQixTQUFTLEVBQUVILFNBQVMsRUFBRUQsV0FBVyxFQUFFLEdBQUc2Qix1QkFBdUIsR0FBR0Y7UUFDeEUsTUFBTUcscUJBQXFCckQsaUVBQWFBLENBQUNvRCx1QkFBdUJ6QixXQUFXSDtRQUMzRSxJQUFJLENBQUM2QixtQkFBbUJDLEtBQUssRUFBRTtZQUMzQnhELG1EQUFNQSxDQUFDMEMsSUFBSSxDQUFDO2dCQUNSVjtnQkFDQVksT0FBT1csbUJBQW1CWCxLQUFLO2dCQUMvQmEsbUJBQW1CNUI7Z0JBQ25CNkIsbUJBQW1CaEM7Z0JBQ25CaUMsY0FBY0MsT0FBT0MsSUFBSSxDQUFDUDtZQUM5QixHQUFHO1lBQ0gsT0FBTzFELHFEQUFZQSxDQUFDK0MsSUFBSSxDQUNwQjtnQkFBRUMsT0FBTztZQUE0QixHQUNyQztnQkFBRUMsUUFBUTtZQUFJO1FBRXRCO1FBRUEsa0JBQWtCO1FBQ2xCLE1BQU1pQixnQkFBZ0I7WUFDbEJyRCxXQUFXWCxvRUFBa0IsQ0FBQ3NELEtBQUszQyxTQUFTLENBQUN1RCxJQUFJO1lBQ2pEbkQsVUFBVWYsb0VBQWtCLENBQUNzRCxLQUFLdkMsUUFBUSxDQUFDbUQsSUFBSTtZQUMvQ2xELE9BQU9zQyxLQUFLdEMsS0FBSyxDQUFDbUQsV0FBVyxHQUFHRCxJQUFJO1lBQ3BDakQsT0FBT3FDLEtBQUtyQyxLQUFLLENBQUNtRCxPQUFPLENBQUMsT0FBTztZQUNqQ2xELFVBQVVsQixvRUFBa0IsQ0FBQ3NELEtBQUtwQyxRQUFRLENBQUNnRCxJQUFJO1lBQy9DRyxVQUFVO2dCQUNObEQsaUJBQWlCbUMsS0FBS25DLGVBQWUsSUFBSTtnQkFDekNFLGFBQWFpQyxLQUFLakMsV0FBVyxJQUFJO2dCQUNqQ0MsdUJBQXVCZ0MsS0FBS2hDLHFCQUFxQixJQUFJO2dCQUNyREMsYUFBYStCLEtBQUsvQixXQUFXLElBQUk7Z0JBQ2pDQyxhQUFhOEIsS0FBSzlCLFdBQVcsSUFBSTtnQkFDakNDLFVBQVU2QixLQUFLN0IsUUFBUSxJQUFJO2dCQUMzQkMsVUFBVTRCLEtBQUs1QixRQUFRLElBQUk7WUFDL0I7UUFDSjtRQUVBLGtDQUFrQztRQUNsQyxNQUFNNEMsVUFBVW5FLHdEQUFXQSxDQUFDb0UsWUFBWSxDQUFDbEM7UUFDekMsSUFBSSxDQUFDaUMsUUFBUUUsT0FBTyxFQUFFO1lBQ2xCdEUsbURBQU1BLENBQUMwQyxJQUFJLENBQUM7Z0JBQUVWO2dCQUFlRztnQkFBSW9DLFlBQVlILFFBQVFHLFVBQVU7WUFBQyxHQUFHO1lBQ25FLE9BQU8zRSxxREFBWUEsQ0FBQytDLElBQUksQ0FDcEI7Z0JBQUVDLE9BQU87WUFBb0IsR0FDN0I7Z0JBQ0lDLFFBQVE7Z0JBQ1JULFNBQVM7b0JBQ0wsZUFBZWdDLFFBQVFHLFVBQVUsRUFBRUMsY0FBYztnQkFDckQ7WUFDSjtRQUVSO1FBRUEscUNBQXFDO1FBQ3JDLE1BQU1DLGFBQWF4RSx3REFBV0EsQ0FBQ3lFLGVBQWUsQ0FBQ1osY0FBY2hELEtBQUs7UUFDbEUsSUFBSSxDQUFDMkQsV0FBV0gsT0FBTyxFQUFFO1lBQ3JCdEUsbURBQU1BLENBQUMwQyxJQUFJLENBQUM7Z0JBQUVWO2dCQUFlbEIsT0FBT2dELGNBQWNoRCxLQUFLO2dCQUFFeUQsWUFBWUUsV0FBV0YsVUFBVTtZQUFDLEdBQUc7WUFDOUYsT0FBTzNFLHFEQUFZQSxDQUFDK0MsSUFBSSxDQUNwQjtnQkFBRUMsT0FBTztZQUFvQixHQUM3QjtnQkFDSUMsUUFBUTtnQkFDUlQsU0FBUztvQkFDTCxlQUFlcUMsV0FBV0YsVUFBVSxFQUFFQyxjQUFjO2dCQUN4RDtZQUNKO1FBRVI7UUFFQSxrQ0FBa0M7UUFDbEN4RSxtREFBTUEsQ0FBQ3VDLElBQUksQ0FBQztZQUFFUDtRQUFjLEdBQUc7UUFDL0IsTUFBTTJDLGtCQUFrQixNQUFNckUsdURBQVVBLENBQUNzRSxhQUFhLENBQ2xEZCxjQUFjaEQsS0FBSyxFQUNuQmdELGNBQWMvQyxLQUFLLEVBQ25CaUI7UUFHSixJQUFJMkMsaUJBQWlCO1lBQ2pCM0UsbURBQU1BLENBQUN1QyxJQUFJLENBQUM7Z0JBQUVQO2dCQUFlNkMsV0FBV0YsZ0JBQWdCRyxFQUFFO1lBQUMsR0FBRztZQUU5RCw0Q0FBNEM7WUFDNUMsTUFBTUMsV0FBVzlDLEtBQUtDLEdBQUcsS0FBS047WUFDOUI1QixtREFBTUEsQ0FBQ3VDLElBQUksQ0FBQztnQkFBRVA7Z0JBQWUrQztZQUFTLEdBQUc7WUFFekMsT0FBT25GLHFEQUFZQSxDQUFDK0MsSUFBSSxDQUFDO2dCQUNyQk0sU0FBUztnQkFDVCtCLFNBQVM7WUFDYjtRQUNKO1FBRUEsMkNBQTJDO1FBQzNDaEYsbURBQU1BLENBQUN1QyxJQUFJLENBQUM7WUFBRVA7UUFBYyxHQUFHO1FBQy9CLE1BQU1pRCxhQUFhLE1BQU0zRSx1REFBVUEsQ0FBQzRFLGFBQWEsQ0FBQ3BCLGVBQWU5QjtRQUVqRSxNQUFNK0MsV0FBVzlDLEtBQUtDLEdBQUcsS0FBS047UUFDOUI1QixtREFBTUEsQ0FBQ3VDLElBQUksQ0FBQztZQUNSUDtZQUNBNkMsV0FBV0ksV0FBV0gsRUFBRTtZQUN4QkM7UUFDSixHQUFHO1FBRUgsT0FBT25GLHFEQUFZQSxDQUFDK0MsSUFBSSxDQUFDO1lBQ3JCTSxTQUFTO1lBQ1QrQixTQUFTO1FBQ2I7SUFFSixFQUFFLE9BQU9wQyxPQUFZO1FBQ2pCLE1BQU1tQyxXQUFXOUMsS0FBS0MsR0FBRyxLQUFLTjtRQUM5QjVCLG1EQUFNQSxDQUFDNEMsS0FBSyxDQUFDO1lBQ1RaO1lBQ0FZLE9BQU9BLE1BQU1vQyxPQUFPO1lBQ3BCRDtRQUNKLEdBQUc7UUFFSCxPQUFPbkYscURBQVlBLENBQUMrQyxJQUFJLENBQ3BCO1lBQUVDLE9BQU87UUFBK0MsR0FDeEQ7WUFBRUMsUUFBUTtRQUFJO0lBRXRCO0FBQ0o7QUFFQSxvQ0FBb0M7QUFDN0IsZUFBZXNDLFFBQVFwRCxPQUFvQjtJQUM5QyxNQUFNcUQsaUJBQWlCQyxRQUFRQyxHQUFHLENBQUNDLGVBQWUsRUFBRWpELE1BQU0sUUFBUSxFQUFFO0lBQ3BFLE1BQU1rRCxTQUFTekQsUUFBUUssT0FBTyxDQUFDQyxHQUFHLENBQUMsYUFBYTtJQUVoRCxNQUFNb0QsWUFBWUwsZUFBZU0sUUFBUSxDQUFDRixXQUN0Q0gsa0JBQXlCO0lBRTdCLElBQUksQ0FBQ0ksV0FBVztRQUNaLE9BQU8sSUFBSTdGLHFEQUFZQSxDQUFDLE1BQU07WUFBRWlELFFBQVE7UUFBSTtJQUNoRDtJQUVBLE9BQU8sSUFBSWpELHFEQUFZQSxDQUFDLE1BQU07UUFDMUJpRCxRQUFRO1FBQ1JULFNBQVM7WUFDTCwrQkFBK0JvRDtZQUMvQixnQ0FBZ0M7WUFDaEMsZ0NBQWdDO1lBQ2hDLDBCQUEwQjtRQUM5QjtJQUNKO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbGlnbmVkLWNoaXJvLS0tbmV4dGdlbi1hc3Nlc3NtZW50Ly4vYXBwL2FwaS9naGwtY29udGFjdC9yb3V0ZS50cz9mNDViIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xyXG5pbXBvcnQgRE9NUHVyaWZ5IGZyb20gJ2lzb21vcnBoaWMtZG9tcHVyaWZ5JztcclxuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSAnbmFub2lkJztcclxuaW1wb3J0IGxvZ2dlciBmcm9tICdAL2xpYi9sb2dnZXInO1xyXG5pbXBvcnQgcmF0ZUxpbWl0ZXIgZnJvbSAnQC9saWIvcmF0ZUxpbWl0ZXInO1xyXG5pbXBvcnQgeyB2ZXJpZnlSZXF1ZXN0IH0gZnJvbSAnQC9saWIvcmVxdWVzdFNpZ25lcic7XHJcbmltcG9ydCB7IGRldGVjdEJvdCwgY2hlY2tIb25leXBvdCwgY2hlY2tTdWJtaXNzaW9uVGltaW5nIH0gZnJvbSAnQC9saWIvYm90RGV0ZWN0aW9uJztcclxuaW1wb3J0IGdobFNlcnZpY2UgZnJvbSAnQC9saWIvZ2hsU2VydmljZSc7XHJcblxyXG4vLyBWYWxpZGF0aW9uIHNjaGVtYVxyXG5jb25zdCBjb250YWN0U2NoZW1hID0gei5vYmplY3Qoe1xyXG4gICAgZmlyc3ROYW1lOiB6LnN0cmluZygpLm1pbigxKS5tYXgoNTApLFxyXG4gICAgbGFzdE5hbWU6IHouc3RyaW5nKCkubWluKDEpLm1heCg1MCksXHJcbiAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgpLm1heCgxMDApLFxyXG4gICAgcGhvbmU6IHouc3RyaW5nKCkubWluKDgpLm1heCgyMCksXHJcbiAgICBwb3N0Y29kZTogei5zdHJpbmcoKS5taW4oMykubWF4KDEwKSxcclxuICAgIG9jY3VwYW5jeVN0YXR1czogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxyXG4gICAgaGVhdGluZ1R5cGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcclxuICAgIHByb2Zlc3Npb25hbFNpdHVhdGlvbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxyXG4gICAgcHJvamVjdFR5cGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcclxuICAgIHN1cmZhY2VBcmVhOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXHJcbiAgICBob3VzZUFnZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxyXG4gICAgdGltZWxpbmU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcclxuICAgIC8vIFNlY3VyaXR5IGZpZWxkc1xyXG4gICAgd2Vic2l0ZV91cmw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSwgLy8gSG9uZXlwb3RcclxuICAgIHRpbWVzdGFtcDogei5udW1iZXIoKSwgLy8gRm9yIEhNQUMgaW50ZWdyaXR5IChub3cpXHJcbiAgICBzdGFydFRpbWU6IHoubnVtYmVyKCksIC8vIEZvciBib3QgdGltaW5nIChtb3VudCB0aW1lKVxyXG4gICAgc2lnbmF0dXJlOiB6LnN0cmluZygpXHJcbn0pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICAgIGNvbnN0IGNvcnJlbGF0aW9uSWQgPSBuYW5vaWQoKTtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICAvLyBHZXQgY2xpZW50IElQXHJcbiAgICAgICAgY29uc3QgaXAgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKT8uc3BsaXQoJywnKVswXSB8fFxyXG4gICAgICAgICAgICByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKSB8fFxyXG4gICAgICAgICAgICAndW5rbm93bic7XHJcblxyXG4gICAgICAgIGxvZ2dlci5pbmZvKHsgY29ycmVsYXRpb25JZCwgaXAgfSwgJ1JlY2VpdmVkIGZvcm0gc3VibWlzc2lvbicpO1xyXG5cclxuICAgICAgICAvLyBDaGVjayByZXF1ZXN0IHNpemUgKDEwS0IgbWF4KVxyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRMZW5ndGggPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdjb250ZW50LWxlbmd0aCcpO1xyXG4gICAgICAgIGlmIChjb250ZW50TGVuZ3RoICYmIHBhcnNlSW50KGNvbnRlbnRMZW5ndGgpID4gMTAyNDApIHtcclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oeyBjb3JyZWxhdGlvbklkLCBjb250ZW50TGVuZ3RoIH0sICdSZXF1ZXN0IHRvbyBsYXJnZScpO1xyXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICAgICAgICB7IGVycm9yOiAnUmVxdWVzdCB0b28gbGFyZ2UnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogNDEzIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFBhcnNlIGJvZHlcclxuICAgICAgICBsZXQgYm9keTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oeyBjb3JyZWxhdGlvbklkIH0sICdJbnZhbGlkIEpTT04nKTtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgcmVxdWVzdCcgfSxcclxuICAgICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgc2NoZW1hXHJcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9IGNvbnRhY3RTY2hlbWEuc2FmZVBhcnNlKGJvZHkpO1xyXG4gICAgICAgIGlmICghdmFsaWRhdGlvblJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKHsgY29ycmVsYXRpb25JZCwgZXJyb3JzOiB2YWxpZGF0aW9uUmVzdWx0LmVycm9yLmlzc3VlcyB9LCAnVmFsaWRhdGlvbiBmYWlsZWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgZm9ybSBkYXRhJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkYXRhID0gdmFsaWRhdGlvblJlc3VsdC5kYXRhO1xyXG5cclxuICAgICAgICAvLyBCb3QgRGV0ZWN0aW9uIExheWVyIDE6IEhvbmV5cG90XHJcbiAgICAgICAgaWYgKGNoZWNrSG9uZXlwb3QoZGF0YS53ZWJzaXRlX3VybCkpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oeyBjb3JyZWxhdGlvbklkIH0sICdCb3QgZGV0ZWN0ZWQ6IGhvbmV5cG90IGZpbGxlZCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICAgICAgICB7IGVycm9yOiAnSW52YWxpZCBzdWJtaXNzaW9uJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBCb3QgRGV0ZWN0aW9uIExheWVyIDI6IFRpbWluZ1xyXG4gICAgICAgIGlmICghY2hlY2tTdWJtaXNzaW9uVGltaW5nKGRhdGEuc3RhcnRUaW1lKSkge1xyXG4gICAgICAgICAgICBsb2dnZXIud2Fybih7IGNvcnJlbGF0aW9uSWQsIHN0YXJ0VGltZTogZGF0YS5zdGFydFRpbWUgfSwgJ0JvdCBkZXRlY3RlZDogaW52YWxpZCB0aW1pbmcnKTtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgc3VibWlzc2lvbicgfSxcclxuICAgICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQm90IERldGVjdGlvbiBMYXllciAzOiBVc2VyLUFnZW50XHJcbiAgICAgICAgY29uc3QgdXNlckFnZW50ID0gcmVxdWVzdC5oZWFkZXJzLmdldCgndXNlci1hZ2VudCcpO1xyXG4gICAgICAgIGlmIChkZXRlY3RCb3QodXNlckFnZW50KSkge1xyXG4gICAgICAgICAgICBsb2dnZXIud2Fybih7IGNvcnJlbGF0aW9uSWQsIHVzZXJBZ2VudCB9LCAnQm90IGRldGVjdGVkOiB1c2VyLWFnZW50Jyk7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIHN1Ym1pc3Npb24nIH0sXHJcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEJvdCBEZXRlY3Rpb24gTGF5ZXIgNDogSE1BQyBTaWduYXR1cmVcclxuICAgICAgICAvLyBFeGNsdWRlIHdlYnNpdGVfdXJsIChob25leXBvdCkgZnJvbSB0aGUgc2lnbmVkIHBheWxvYWRcclxuICAgICAgICBjb25zdCB7IHNpZ25hdHVyZSwgdGltZXN0YW1wLCB3ZWJzaXRlX3VybCwgLi4uZm9ybURhdGFXaXRoU3RhcnRUaW1lIH0gPSBkYXRhO1xyXG4gICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlc3VsdCA9IHZlcmlmeVJlcXVlc3QoZm9ybURhdGFXaXRoU3RhcnRUaW1lLCBzaWduYXR1cmUsIHRpbWVzdGFtcCk7XHJcbiAgICAgICAgaWYgKCF2ZXJpZmljYXRpb25SZXN1bHQudmFsaWQpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oe1xyXG4gICAgICAgICAgICAgICAgY29ycmVsYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIGVycm9yOiB2ZXJpZmljYXRpb25SZXN1bHQuZXJyb3IsXHJcbiAgICAgICAgICAgICAgICByZWNlaXZlZFNpZ25hdHVyZTogc2lnbmF0dXJlLFxyXG4gICAgICAgICAgICAgICAgcmVjZWl2ZWRUaW1lc3RhbXA6IHRpbWVzdGFtcCxcclxuICAgICAgICAgICAgICAgIGZvcm1EYXRhS2V5czogT2JqZWN0LmtleXMoZm9ybURhdGFXaXRoU3RhcnRUaW1lKVxyXG4gICAgICAgICAgICB9LCAnSW52YWxpZCBzaWduYXR1cmUnKTtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgcmVxdWVzdCBzaWduYXR1cmUnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNhbml0aXplIGlucHV0c1xyXG4gICAgICAgIGNvbnN0IHNhbml0aXplZERhdGEgPSB7XHJcbiAgICAgICAgICAgIGZpcnN0TmFtZTogRE9NUHVyaWZ5LnNhbml0aXplKGRhdGEuZmlyc3ROYW1lLnRyaW0oKSksXHJcbiAgICAgICAgICAgIGxhc3ROYW1lOiBET01QdXJpZnkuc2FuaXRpemUoZGF0YS5sYXN0TmFtZS50cmltKCkpLFxyXG4gICAgICAgICAgICBlbWFpbDogZGF0YS5lbWFpbC50b0xvd2VyQ2FzZSgpLnRyaW0oKSxcclxuICAgICAgICAgICAgcGhvbmU6IGRhdGEucGhvbmUucmVwbGFjZSgvXFxEL2csICcnKSwgLy8gUmVtb3ZlIG5vbi1kaWdpdHNcclxuICAgICAgICAgICAgcG9zdGNvZGU6IERPTVB1cmlmeS5zYW5pdGl6ZShkYXRhLnBvc3Rjb2RlLnRyaW0oKSksXHJcbiAgICAgICAgICAgIHF1aXpEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBvY2N1cGFuY3lTdGF0dXM6IGRhdGEub2NjdXBhbmN5U3RhdHVzIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaGVhdGluZ1R5cGU6IGRhdGEuaGVhdGluZ1R5cGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBwcm9mZXNzaW9uYWxTaXR1YXRpb246IGRhdGEucHJvZmVzc2lvbmFsU2l0dWF0aW9uIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgcHJvamVjdFR5cGU6IGRhdGEucHJvamVjdFR5cGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBzdXJmYWNlQXJlYTogZGF0YS5zdXJmYWNlQXJlYSB8fCAnJyxcclxuICAgICAgICAgICAgICAgIGhvdXNlQWdlOiBkYXRhLmhvdXNlQWdlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgdGltZWxpbmU6IGRhdGEudGltZWxpbmUgfHwgJydcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFJhdGUgTGltaXRpbmcgTGF5ZXIgMTogSVAtYmFzZWRcclxuICAgICAgICBjb25zdCBpcExpbWl0ID0gcmF0ZUxpbWl0ZXIuY2hlY2tJUExpbWl0KGlwKTtcclxuICAgICAgICBpZiAoIWlwTGltaXQuYWxsb3dlZCkge1xyXG4gICAgICAgICAgICBsb2dnZXIud2Fybih7IGNvcnJlbGF0aW9uSWQsIGlwLCByZXRyeUFmdGVyOiBpcExpbWl0LnJldHJ5QWZ0ZXIgfSwgJ1JhdGUgbGltaXQgZXhjZWVkZWQ6IElQJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdUb28gbWFueSByZXF1ZXN0cycgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDQyOSxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdSZXRyeS1BZnRlcic6IGlwTGltaXQucmV0cnlBZnRlcj8udG9TdHJpbmcoKSB8fCAnOTAwJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJhdGUgTGltaXRpbmcgTGF5ZXIgMjogRW1haWwtYmFzZWRcclxuICAgICAgICBjb25zdCBlbWFpbExpbWl0ID0gcmF0ZUxpbWl0ZXIuY2hlY2tFbWFpbExpbWl0KHNhbml0aXplZERhdGEuZW1haWwpO1xyXG4gICAgICAgIGlmICghZW1haWxMaW1pdC5hbGxvd2VkKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKHsgY29ycmVsYXRpb25JZCwgZW1haWw6IHNhbml0aXplZERhdGEuZW1haWwsIHJldHJ5QWZ0ZXI6IGVtYWlsTGltaXQucmV0cnlBZnRlciB9LCAnUmF0ZSBsaW1pdCBleGNlZWRlZDogRW1haWwnKTtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ1RvbyBtYW55IHJlcXVlc3RzJyB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogNDI5LFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ1JldHJ5LUFmdGVyJzogZW1haWxMaW1pdC5yZXRyeUFmdGVyPy50b1N0cmluZygpIHx8ICczNjAwJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIGNvbnRhY3QgYWxyZWFkeSBleGlzdHNcclxuICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQgfSwgJ0NoZWNraW5nIGlmIGNvbnRhY3QgZXhpc3RzJyk7XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdDb250YWN0ID0gYXdhaXQgZ2hsU2VydmljZS5jb250YWN0RXhpc3RzKFxyXG4gICAgICAgICAgICBzYW5pdGl6ZWREYXRhLmVtYWlsLFxyXG4gICAgICAgICAgICBzYW5pdGl6ZWREYXRhLnBob25lLFxyXG4gICAgICAgICAgICBjb3JyZWxhdGlvbklkXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKGV4aXN0aW5nQ29udGFjdCkge1xyXG4gICAgICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQsIGNvbnRhY3RJZDogZXhpc3RpbmdDb250YWN0LmlkIH0sICdDb250YWN0IGFscmVhZHkgZXhpc3RzLCBza2lwcGluZyBjcmVhdGlvbicpO1xyXG5cclxuICAgICAgICAgICAgLy8gUmV0dXJuIHN1Y2Nlc3MgYnV0IGRvbid0IGNyZWF0ZSBkdXBsaWNhdGVcclxuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xyXG4gICAgICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQsIGR1cmF0aW9uIH0sICdSZXF1ZXN0IGNvbXBsZXRlZCAoZXhpc3RpbmcgY29udGFjdCknKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1RoYW5rIHlvdSBmb3IgeW91ciBzdWJtaXNzaW9uJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBuZXcgY29udGFjdCB3aXRoIHdlYnNpdGVfbGVhZCB0YWdcclxuICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQgfSwgJ0NyZWF0aW5nIG5ldyBjb250YWN0Jyk7XHJcbiAgICAgICAgY29uc3QgbmV3Q29udGFjdCA9IGF3YWl0IGdobFNlcnZpY2UuY3JlYXRlQ29udGFjdChzYW5pdGl6ZWREYXRhLCBjb3JyZWxhdGlvbklkKTtcclxuXHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xyXG4gICAgICAgIGxvZ2dlci5pbmZvKHtcclxuICAgICAgICAgICAgY29ycmVsYXRpb25JZCxcclxuICAgICAgICAgICAgY29udGFjdElkOiBuZXdDb250YWN0LmlkLFxyXG4gICAgICAgICAgICBkdXJhdGlvblxyXG4gICAgICAgIH0sICdDb250YWN0IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcblxyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUaGFuayB5b3UgZm9yIHlvdXIgc3VibWlzc2lvbidcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xyXG4gICAgICAgIGxvZ2dlci5lcnJvcih7XHJcbiAgICAgICAgICAgIGNvcnJlbGF0aW9uSWQsXHJcbiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgICAgICBkdXJhdGlvblxyXG4gICAgICAgIH0sICdFcnJvciBwcm9jZXNzaW5nIGZvcm0gc3VibWlzc2lvbicpO1xyXG5cclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICAgIHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCBwcm9jZXNzaW5nIHlvdXIgc3VibWlzc2lvbicgfSxcclxuICAgICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gSGFuZGxlIE9QVElPTlMgZm9yIENPUlMgcHJlZmxpZ2h0XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPUFRJT05TKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgICBjb25zdCBhbGxvd2VkT3JpZ2lucyA9IHByb2Nlc3MuZW52LkFMTE9XRURfT1JJR0lOUz8uc3BsaXQoJywnKSB8fCBbXTtcclxuICAgIGNvbnN0IG9yaWdpbiA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ29yaWdpbicpIHx8ICcnO1xyXG5cclxuICAgIGNvbnN0IGlzQWxsb3dlZCA9IGFsbG93ZWRPcmlnaW5zLmluY2x1ZGVzKG9yaWdpbikgfHxcclxuICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcclxuXHJcbiAgICBpZiAoIWlzQWxsb3dlZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHsgc3RhdHVzOiA0MDMgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UobnVsbCwge1xyXG4gICAgICAgIHN0YXR1czogMjAwLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6IG9yaWdpbixcclxuICAgICAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiAnUE9TVCwgT1BUSU9OUycsXHJcbiAgICAgICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJzogJ0NvbnRlbnQtVHlwZScsXHJcbiAgICAgICAgICAgICdBY2Nlc3MtQ29udHJvbC1NYXgtQWdlJzogJzg2NDAwJyxcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInoiLCJET01QdXJpZnkiLCJuYW5vaWQiLCJsb2dnZXIiLCJyYXRlTGltaXRlciIsInZlcmlmeVJlcXVlc3QiLCJkZXRlY3RCb3QiLCJjaGVja0hvbmV5cG90IiwiY2hlY2tTdWJtaXNzaW9uVGltaW5nIiwiZ2hsU2VydmljZSIsImNvbnRhY3RTY2hlbWEiLCJvYmplY3QiLCJmaXJzdE5hbWUiLCJzdHJpbmciLCJtaW4iLCJtYXgiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmUiLCJwb3N0Y29kZSIsIm9jY3VwYW5jeVN0YXR1cyIsIm9wdGlvbmFsIiwiaGVhdGluZ1R5cGUiLCJwcm9mZXNzaW9uYWxTaXR1YXRpb24iLCJwcm9qZWN0VHlwZSIsInN1cmZhY2VBcmVhIiwiaG91c2VBZ2UiLCJ0aW1lbGluZSIsIndlYnNpdGVfdXJsIiwidGltZXN0YW1wIiwibnVtYmVyIiwic3RhcnRUaW1lIiwic2lnbmF0dXJlIiwiUE9TVCIsInJlcXVlc3QiLCJjb3JyZWxhdGlvbklkIiwiRGF0ZSIsIm5vdyIsImlwIiwiaGVhZGVycyIsImdldCIsInNwbGl0IiwiaW5mbyIsImNvbnRlbnRMZW5ndGgiLCJwYXJzZUludCIsIndhcm4iLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJib2R5IiwidmFsaWRhdGlvblJlc3VsdCIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJlcnJvcnMiLCJpc3N1ZXMiLCJkYXRhIiwidXNlckFnZW50IiwiZm9ybURhdGFXaXRoU3RhcnRUaW1lIiwidmVyaWZpY2F0aW9uUmVzdWx0IiwidmFsaWQiLCJyZWNlaXZlZFNpZ25hdHVyZSIsInJlY2VpdmVkVGltZXN0YW1wIiwiZm9ybURhdGFLZXlzIiwiT2JqZWN0Iiwia2V5cyIsInNhbml0aXplZERhdGEiLCJzYW5pdGl6ZSIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJxdWl6RGF0YSIsImlwTGltaXQiLCJjaGVja0lQTGltaXQiLCJhbGxvd2VkIiwicmV0cnlBZnRlciIsInRvU3RyaW5nIiwiZW1haWxMaW1pdCIsImNoZWNrRW1haWxMaW1pdCIsImV4aXN0aW5nQ29udGFjdCIsImNvbnRhY3RFeGlzdHMiLCJjb250YWN0SWQiLCJpZCIsImR1cmF0aW9uIiwibWVzc2FnZSIsIm5ld0NvbnRhY3QiLCJjcmVhdGVDb250YWN0IiwiT1BUSU9OUyIsImFsbG93ZWRPcmlnaW5zIiwicHJvY2VzcyIsImVudiIsIkFMTE9XRURfT1JJR0lOUyIsIm9yaWdpbiIsImlzQWxsb3dlZCIsImluY2x1ZGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ghl-contact/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/botDetection.ts":
/*!*****************************!*\
  !*** ./lib/botDetection.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkHoneypot: () => (/* binding */ checkHoneypot),\n/* harmony export */   checkSubmissionTiming: () => (/* binding */ checkSubmissionTiming),\n/* harmony export */   detectBot: () => (/* binding */ detectBot),\n/* harmony export */   generateFingerprint: () => (/* binding */ generateFingerprint)\n/* harmony export */ });\nfunction detectBot(userAgent) {\n    if (!userAgent) return true; // No user agent = likely bot\n    const botPatterns = [\n        /bot/i,\n        /crawler/i,\n        /spider/i,\n        /scraper/i,\n        /curl/i,\n        /wget/i,\n        /python/i,\n        /java/i,\n        /http/i,\n        /postman/i\n    ];\n    return botPatterns.some((pattern)=>pattern.test(userAgent));\n}\nfunction checkHoneypot(honeypotValue) {\n    // If honeypot field is filled, it's a bot\n    return !!honeypotValue && honeypotValue.trim().length > 0;\n}\nfunction checkSubmissionTiming(timestamp) {\n    const now = Date.now();\n    const minTime = 2000; // 2 seconds minimum\n    const elapsed = now - timestamp;\n    // Too fast = bot\n    if (elapsed < minTime) return false;\n    // Too old (more than 1 hour) = suspicious\n    if (elapsed > 60 * 60 * 1000) return false;\n    return true;\n}\nfunction generateFingerprint(data) {\n    const parts = [\n        data.userAgent || \"\",\n        data.acceptLanguage || \"\",\n        data.acceptEncoding || \"\"\n    ];\n    return Buffer.from(parts.join(\"|\")).toString(\"base64\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYm90RGV0ZWN0aW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxTQUFTQSxVQUFVQyxTQUF3QjtJQUM5QyxJQUFJLENBQUNBLFdBQVcsT0FBTyxNQUFNLDZCQUE2QjtJQUUxRCxNQUFNQyxjQUFjO1FBQ2hCO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0g7SUFFRCxPQUFPQSxZQUFZQyxJQUFJLENBQUNDLENBQUFBLFVBQVdBLFFBQVFDLElBQUksQ0FBQ0o7QUFDcEQ7QUFFTyxTQUFTSyxjQUFjQyxhQUFpQztJQUMzRCwwQ0FBMEM7SUFDMUMsT0FBTyxDQUFDLENBQUNBLGlCQUFpQkEsY0FBY0MsSUFBSSxHQUFHQyxNQUFNLEdBQUc7QUFDNUQ7QUFFTyxTQUFTQyxzQkFBc0JDLFNBQWlCO0lBQ25ELE1BQU1DLE1BQU1DLEtBQUtELEdBQUc7SUFDcEIsTUFBTUUsVUFBVSxNQUFNLG9CQUFvQjtJQUMxQyxNQUFNQyxVQUFVSCxNQUFNRDtJQUV0QixpQkFBaUI7SUFDakIsSUFBSUksVUFBVUQsU0FBUyxPQUFPO0lBRTlCLDBDQUEwQztJQUMxQyxJQUFJQyxVQUFVLEtBQUssS0FBSyxNQUFNLE9BQU87SUFFckMsT0FBTztBQUNYO0FBRU8sU0FBU0Msb0JBQW9CQyxJQUluQztJQUNHLE1BQU1DLFFBQVE7UUFDVkQsS0FBS2hCLFNBQVMsSUFBSTtRQUNsQmdCLEtBQUtFLGNBQWMsSUFBSTtRQUN2QkYsS0FBS0csY0FBYyxJQUFJO0tBQzFCO0lBRUQsT0FBT0MsT0FBT0MsSUFBSSxDQUFDSixNQUFNSyxJQUFJLENBQUMsTUFBTUMsUUFBUSxDQUFDO0FBQ2pEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWxpZ25lZC1jaGlyby0tLW5leHRnZW4tYXNzZXNzbWVudC8uL2xpYi9ib3REZXRlY3Rpb24udHM/ZGM4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZGV0ZWN0Qm90KHVzZXJBZ2VudDogc3RyaW5nIHwgbnVsbCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCF1c2VyQWdlbnQpIHJldHVybiB0cnVlOyAvLyBObyB1c2VyIGFnZW50ID0gbGlrZWx5IGJvdFxyXG5cclxuICAgIGNvbnN0IGJvdFBhdHRlcm5zID0gW1xyXG4gICAgICAgIC9ib3QvaSxcclxuICAgICAgICAvY3Jhd2xlci9pLFxyXG4gICAgICAgIC9zcGlkZXIvaSxcclxuICAgICAgICAvc2NyYXBlci9pLFxyXG4gICAgICAgIC9jdXJsL2ksXHJcbiAgICAgICAgL3dnZXQvaSxcclxuICAgICAgICAvcHl0aG9uL2ksXHJcbiAgICAgICAgL2phdmEvaSxcclxuICAgICAgICAvaHR0cC9pLFxyXG4gICAgICAgIC9wb3N0bWFuL2lcclxuICAgIF07XHJcblxyXG4gICAgcmV0dXJuIGJvdFBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QodXNlckFnZW50KSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0hvbmV5cG90KGhvbmV5cG90VmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCk6IGJvb2xlYW4ge1xyXG4gICAgLy8gSWYgaG9uZXlwb3QgZmllbGQgaXMgZmlsbGVkLCBpdCdzIGEgYm90XHJcbiAgICByZXR1cm4gISFob25leXBvdFZhbHVlICYmIGhvbmV5cG90VmFsdWUudHJpbSgpLmxlbmd0aCA+IDA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja1N1Ym1pc3Npb25UaW1pbmcodGltZXN0YW1wOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCBtaW5UaW1lID0gMjAwMDsgLy8gMiBzZWNvbmRzIG1pbmltdW1cclxuICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSB0aW1lc3RhbXA7XHJcblxyXG4gICAgLy8gVG9vIGZhc3QgPSBib3RcclxuICAgIGlmIChlbGFwc2VkIDwgbWluVGltZSkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIC8vIFRvbyBvbGQgKG1vcmUgdGhhbiAxIGhvdXIpID0gc3VzcGljaW91c1xyXG4gICAgaWYgKGVsYXBzZWQgPiA2MCAqIDYwICogMTAwMCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVGaW5nZXJwcmludChkYXRhOiB7XHJcbiAgICB1c2VyQWdlbnQ/OiBzdHJpbmc7XHJcbiAgICBhY2NlcHRMYW5ndWFnZT86IHN0cmluZztcclxuICAgIGFjY2VwdEVuY29kaW5nPzogc3RyaW5nO1xyXG59KTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHBhcnRzID0gW1xyXG4gICAgICAgIGRhdGEudXNlckFnZW50IHx8ICcnLFxyXG4gICAgICAgIGRhdGEuYWNjZXB0TGFuZ3VhZ2UgfHwgJycsXHJcbiAgICAgICAgZGF0YS5hY2NlcHRFbmNvZGluZyB8fCAnJ1xyXG4gICAgXTtcclxuXHJcbiAgICByZXR1cm4gQnVmZmVyLmZyb20ocGFydHMuam9pbignfCcpKS50b1N0cmluZygnYmFzZTY0Jyk7XHJcbn1cclxuIl0sIm5hbWVzIjpbImRldGVjdEJvdCIsInVzZXJBZ2VudCIsImJvdFBhdHRlcm5zIiwic29tZSIsInBhdHRlcm4iLCJ0ZXN0IiwiY2hlY2tIb25leXBvdCIsImhvbmV5cG90VmFsdWUiLCJ0cmltIiwibGVuZ3RoIiwiY2hlY2tTdWJtaXNzaW9uVGltaW5nIiwidGltZXN0YW1wIiwibm93IiwiRGF0ZSIsIm1pblRpbWUiLCJlbGFwc2VkIiwiZ2VuZXJhdGVGaW5nZXJwcmludCIsImRhdGEiLCJwYXJ0cyIsImFjY2VwdExhbmd1YWdlIiwiYWNjZXB0RW5jb2RpbmciLCJCdWZmZXIiLCJmcm9tIiwiam9pbiIsInRvU3RyaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/botDetection.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ghlService.ts":
/*!***************************!*\
  !*** ./lib/ghlService.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var libphonenumber_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! libphonenumber-js */ \"(rsc)/./node_modules/libphonenumber-js/min/exports/parsePhoneNumberWithError.js\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logger */ \"(rsc)/./lib/logger.ts\");\n\n\n\nconst GHL_API_BASE_URL = process.env.GHL_API_BASE_URL || \"https://services.leadconnectorhq.com\";\nconst GHL_API_KEY = process.env.GHL_API_KEY || \"\"; // This will be the Private Integration Token\nconst GHL_LOCATION_ID = process.env.GHL_LOCATION_ID || \"\";\nconst GHL_API_TIMEOUT = parseInt(process.env.GHL_API_TIMEOUT || \"10000\");\nconst GHL_MOCK_MODE = process.env.GHL_MOCK_MODE === \"true\";\nclass GoHighLevelService {\n    constructor(){\n        this.client = axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].create({\n            baseURL: GHL_API_BASE_URL,\n            timeout: GHL_API_TIMEOUT,\n            headers: {\n                \"Authorization\": `Bearer ${GHL_API_KEY}`,\n                \"Content-Type\": \"application/json\",\n                \"Version\": \"2021-07-28\" // Required for API v2\n            }\n        });\n    }\n    isMock() {\n        return GHL_MOCK_MODE || !GHL_API_KEY || GHL_API_KEY === \"your_private_integration_token_here\";\n    }\n    /**\r\n     * Normalize phone number to E.164 format\r\n     */ normalizePhone(phone, defaultCountry = \"FR\") {\n        try {\n            // Remove all non-digits first\n            const cleaned = phone.replace(/\\D/g, \"\");\n            // Parse and format\n            const phoneNumber = (0,libphonenumber_js__WEBPACK_IMPORTED_MODULE_2__.parsePhoneNumberWithError)(cleaned, defaultCountry);\n            if (phoneNumber && phoneNumber.isValid()) {\n                return phoneNumber.format(\"E.164\");\n            }\n            // If parsing fails, return original cleaned number with + prefix\n            return `+${cleaned}`;\n        } catch (error) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].warn({\n                phone,\n                error\n            }, \"Phone normalization failed, using original\");\n            return phone;\n        }\n    }\n    /**\r\n     * Search for contact by email\r\n     */ async searchByEmail(email, correlationId) {\n        if (this.isMock()) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                email\n            }, \"[MOCK] Searching contact by email (Simulating not found)\");\n            return null;\n        }\n        try {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                email\n            }, \"Searching contact by email\");\n            const response = await this.client.get(`/contacts/`, {\n                params: {\n                    locationId: GHL_LOCATION_ID,\n                    email: email.toLowerCase().trim()\n                }\n            });\n            const contacts = response.data.contacts || [];\n            if (contacts.length > 0) {\n                _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                    correlationId,\n                    contactId: contacts[0].id\n                }, \"Contact found by email\");\n                return contacts[0];\n            }\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId\n            }, \"No contact found by email\");\n            return null;\n        } catch (error) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].error({\n                correlationId,\n                error: error.message\n            }, \"Error searching contact by email\");\n            throw new Error(\"Failed to search contact by email\");\n        }\n    }\n    /**\r\n     * Search for contact by phone\r\n     */ async searchByPhone(phone, correlationId) {\n        if (this.isMock()) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                phone\n            }, \"[MOCK] Searching contact by phone (Simulating not found)\");\n            return null;\n        }\n        try {\n            const normalizedPhone = this.normalizePhone(phone);\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                phone: normalizedPhone\n            }, \"Searching contact by phone\");\n            const response = await this.client.get(`/contacts/`, {\n                params: {\n                    locationId: GHL_LOCATION_ID,\n                    query: normalizedPhone\n                }\n            });\n            const contacts = response.data.contacts || [];\n            if (contacts.length > 0) {\n                _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                    correlationId,\n                    contactId: contacts[0].id\n                }, \"Contact found by phone\");\n                return contacts[0];\n            }\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId\n            }, \"No contact found by phone\");\n            return null;\n        } catch (error) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].error({\n                correlationId,\n                error: error.message\n            }, \"Error searching contact by phone\");\n            throw new Error(\"Failed to search contact by phone\");\n        }\n    }\n    /**\r\n     * Create new contact with website_lead tag\r\n     * CRITICAL: Tag must be included in creation payload for workflow trigger\r\n     */ async createContact(data, correlationId) {\n        if (this.isMock()) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                email: data.email\n            }, \"[MOCK] Creating new contact (Simulating success)\");\n            return {\n                id: \"mock-contact-id-\" + Date.now(),\n                email: data.email,\n                firstName: data.firstName,\n                lastName: data.lastName,\n                tags: [\n                    \"website_lead\"\n                ]\n            };\n        }\n        try {\n            const normalizedPhone = this.normalizePhone(data.phone);\n            const payload = {\n                locationId: GHL_LOCATION_ID,\n                firstName: data.firstName.trim(),\n                lastName: data.lastName.trim(),\n                email: data.email.toLowerCase().trim(),\n                phone: normalizedPhone,\n                tags: [\n                    \"website_lead\"\n                ],\n                customFields: [\n                    {\n                        id: \"postcode\",\n                        value: data.postcode\n                    },\n                    {\n                        id: \"occupancyStatus\",\n                        value: data.quizData.occupancyStatus || \"\"\n                    },\n                    {\n                        id: \"heatingType\",\n                        value: data.quizData.heatingType || \"\"\n                    },\n                    {\n                        id: \"professionalSituation\",\n                        value: data.quizData.professionalSituation || \"\"\n                    },\n                    {\n                        id: \"source\",\n                        value: \"website_quiz\"\n                    },\n                    {\n                        id: \"submissionDate\",\n                        value: new Date().toISOString()\n                    }\n                ]\n            };\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                email: payload.email\n            }, \"Creating new contact with website_lead tag (API v2)\");\n            const response = await this.client.post(\"/contacts/\", payload);\n            const contact = response.data.contact;\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].info({\n                correlationId,\n                contactId: contact.id\n            }, \"Contact created successfully\");\n            return contact;\n        } catch (error) {\n            _logger__WEBPACK_IMPORTED_MODULE_0__[\"default\"].error({\n                correlationId,\n                error: error.message,\n                response: error.response?.data\n            }, \"Error creating contact\");\n            throw new Error(\"Failed to create contact in GoHighLevel\");\n        }\n    }\n    /**\r\n     * Check if contact exists (email first, phone fallback)\r\n     */ async contactExists(email, phone, correlationId) {\n        // Try email first\n        const contactByEmail = await this.searchByEmail(email, correlationId);\n        if (contactByEmail) return contactByEmail;\n        // Fallback to phone\n        const contactByPhone = await this.searchByPhone(phone, correlationId);\n        return contactByPhone;\n    }\n}\n// Singleton instance\nconst ghlService = new GoHighLevelService();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ghlService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUksQ0FBQyxjQUFjVDtZQUV0RCxNQUFNVSxVQUFVaEMsU0FBU08sSUFBSSxDQUFDeUIsT0FBTztZQUNyQy9ELCtDQUFNQSxDQUFDOEIsSUFBSSxDQUFDO2dCQUFFRDtnQkFBZVcsV0FBV3VCLFFBQVF0QixFQUFFO1lBQUMsR0FBRztZQUV0RCxPQUFPc0I7UUFDWCxFQUFFLE9BQU90QyxPQUFZO1lBQ2pCekIsK0NBQU1BLENBQUN5QixLQUFLLENBQUM7Z0JBQ1RJO2dCQUNBSixPQUFPQSxNQUFNaUIsT0FBTztnQkFDcEJYLFVBQVVOLE1BQU1NLFFBQVEsRUFBRU87WUFDOUIsR0FBRztZQUNILE1BQU0sSUFBSUssTUFBTTtRQUNwQjtJQUNKO0lBRUE7O0tBRUMsR0FDRCxNQUFNcUIsY0FBY3BDLEtBQWEsRUFBRVYsS0FBYSxFQUFFVyxhQUFxQixFQUE4QjtRQUNqRyxrQkFBa0I7UUFDbEIsTUFBTW9DLGlCQUFpQixNQUFNLElBQUksQ0FBQ3RDLGFBQWEsQ0FBQ0MsT0FBT0M7UUFDdkQsSUFBSW9DLGdCQUFnQixPQUFPQTtRQUUzQixvQkFBb0I7UUFDcEIsTUFBTUMsaUJBQWlCLE1BQU0sSUFBSSxDQUFDdEIsYUFBYSxDQUFDMUIsT0FBT1c7UUFDdkQsT0FBT3FDO0lBQ1g7QUFDSjtBQUVBLHFCQUFxQjtBQUNyQixNQUFNQyxhQUFhLElBQUkxRDtBQUV2QixpRUFBZTBELFVBQVVBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbGlnbmVkLWNoaXJvLS0tbmV4dGdlbi1hc3Nlc3NtZW50Ly4vbGliL2dobFNlcnZpY2UudHM/ZWY2ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MsIHsgQXhpb3NJbnN0YW5jZSB9IGZyb20gJ2F4aW9zJztcclxuaW1wb3J0IHsgcGFyc2VQaG9uZU51bWJlciwgQ291bnRyeUNvZGUgfSBmcm9tICdsaWJwaG9uZW51bWJlci1qcyc7XHJcbmltcG9ydCBsb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xyXG5cclxuY29uc3QgR0hMX0FQSV9CQVNFX1VSTCA9IHByb2Nlc3MuZW52LkdITF9BUElfQkFTRV9VUkwgfHwgJ2h0dHBzOi8vc2VydmljZXMubGVhZGNvbm5lY3RvcmhxLmNvbSc7XHJcbmNvbnN0IEdITF9BUElfS0VZID0gcHJvY2Vzcy5lbnYuR0hMX0FQSV9LRVkgfHwgJyc7IC8vIFRoaXMgd2lsbCBiZSB0aGUgUHJpdmF0ZSBJbnRlZ3JhdGlvbiBUb2tlblxyXG5jb25zdCBHSExfTE9DQVRJT05fSUQgPSBwcm9jZXNzLmVudi5HSExfTE9DQVRJT05fSUQgfHwgJyc7XHJcbmNvbnN0IEdITF9BUElfVElNRU9VVCA9IHBhcnNlSW50KHByb2Nlc3MuZW52LkdITF9BUElfVElNRU9VVCB8fCAnMTAwMDAnKTtcclxuY29uc3QgR0hMX01PQ0tfTU9ERSA9IHByb2Nlc3MuZW52LkdITF9NT0NLX01PREUgPT09ICd0cnVlJztcclxuXHJcbmludGVyZmFjZSBHSExDb250YWN0IHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBlbWFpbD86IHN0cmluZztcclxuICAgIHBob25lPzogc3RyaW5nO1xyXG4gICAgZmlyc3ROYW1lPzogc3RyaW5nO1xyXG4gICAgbGFzdE5hbWU/OiBzdHJpbmc7XHJcbiAgICB0YWdzPzogc3RyaW5nW107XHJcbn1cclxuXHJcbmludGVyZmFjZSBDcmVhdGVDb250YWN0RGF0YSB7XHJcbiAgICBmaXJzdE5hbWU6IHN0cmluZztcclxuICAgIGxhc3ROYW1lOiBzdHJpbmc7XHJcbiAgICBlbWFpbDogc3RyaW5nO1xyXG4gICAgcGhvbmU6IHN0cmluZztcclxuICAgIHBvc3Rjb2RlOiBzdHJpbmc7XHJcbiAgICBxdWl6RGF0YTogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcclxufVxyXG5cclxuY2xhc3MgR29IaWdoTGV2ZWxTZXJ2aWNlIHtcclxuICAgIHByaXZhdGUgY2xpZW50OiBBeGlvc0luc3RhbmNlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuY2xpZW50ID0gYXhpb3MuY3JlYXRlKHtcclxuICAgICAgICAgICAgYmFzZVVSTDogR0hMX0FQSV9CQVNFX1VSTCxcclxuICAgICAgICAgICAgdGltZW91dDogR0hMX0FQSV9USU1FT1VULFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtHSExfQVBJX0tFWX1gLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgICAgICdWZXJzaW9uJzogJzIwMjEtMDctMjgnIC8vIFJlcXVpcmVkIGZvciBBUEkgdjJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaXNNb2NrKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBHSExfTU9DS19NT0RFIHx8ICFHSExfQVBJX0tFWSB8fCBHSExfQVBJX0tFWSA9PT0gJ3lvdXJfcHJpdmF0ZV9pbnRlZ3JhdGlvbl90b2tlbl9oZXJlJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE5vcm1hbGl6ZSBwaG9uZSBudW1iZXIgdG8gRS4xNjQgZm9ybWF0XHJcbiAgICAgKi9cclxuICAgIG5vcm1hbGl6ZVBob25lKHBob25lOiBzdHJpbmcsIGRlZmF1bHRDb3VudHJ5OiBDb3VudHJ5Q29kZSA9ICdGUicpOiBzdHJpbmcge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBhbGwgbm9uLWRpZ2l0cyBmaXJzdFxyXG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkID0gcGhvbmUucmVwbGFjZSgvXFxEL2csICcnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFBhcnNlIGFuZCBmb3JtYXRcclxuICAgICAgICAgICAgY29uc3QgcGhvbmVOdW1iZXIgPSBwYXJzZVBob25lTnVtYmVyKGNsZWFuZWQsIGRlZmF1bHRDb3VudHJ5KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwaG9uZU51bWJlciAmJiBwaG9uZU51bWJlci5pc1ZhbGlkKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwaG9uZU51bWJlci5mb3JtYXQoJ0UuMTY0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIElmIHBhcnNpbmcgZmFpbHMsIHJldHVybiBvcmlnaW5hbCBjbGVhbmVkIG51bWJlciB3aXRoICsgcHJlZml4XHJcbiAgICAgICAgICAgIHJldHVybiBgKyR7Y2xlYW5lZH1gO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKHsgcGhvbmUsIGVycm9yIH0sICdQaG9uZSBub3JtYWxpemF0aW9uIGZhaWxlZCwgdXNpbmcgb3JpZ2luYWwnKTtcclxuICAgICAgICAgICAgcmV0dXJuIHBob25lO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNlYXJjaCBmb3IgY29udGFjdCBieSBlbWFpbFxyXG4gICAgICovXHJcbiAgICBhc3luYyBzZWFyY2hCeUVtYWlsKGVtYWlsOiBzdHJpbmcsIGNvcnJlbGF0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8R0hMQ29udGFjdCB8IG51bGw+IHtcclxuICAgICAgICBpZiAodGhpcy5pc01vY2soKSkge1xyXG4gICAgICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQsIGVtYWlsIH0sICdbTU9DS10gU2VhcmNoaW5nIGNvbnRhY3QgYnkgZW1haWwgKFNpbXVsYXRpbmcgbm90IGZvdW5kKScpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oeyBjb3JyZWxhdGlvbklkLCBlbWFpbCB9LCAnU2VhcmNoaW5nIGNvbnRhY3QgYnkgZW1haWwnKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0KGAvY29udGFjdHMvYCwge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogR0hMX0xPQ0FUSU9OX0lELFxyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhY3RzID0gcmVzcG9uc2UuZGF0YS5jb250YWN0cyB8fCBbXTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjb250YWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQsIGNvbnRhY3RJZDogY29udGFjdHNbMF0uaWQgfSwgJ0NvbnRhY3QgZm91bmQgYnkgZW1haWwnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb250YWN0c1swXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oeyBjb3JyZWxhdGlvbklkIH0sICdObyBjb250YWN0IGZvdW5kIGJ5IGVtYWlsJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKHsgY29ycmVsYXRpb25JZCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgJ0Vycm9yIHNlYXJjaGluZyBjb250YWN0IGJ5IGVtYWlsJyk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHNlYXJjaCBjb250YWN0IGJ5IGVtYWlsJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2VhcmNoIGZvciBjb250YWN0IGJ5IHBob25lXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHNlYXJjaEJ5UGhvbmUocGhvbmU6IHN0cmluZywgY29ycmVsYXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTxHSExDb250YWN0IHwgbnVsbD4ge1xyXG4gICAgICAgIGlmICh0aGlzLmlzTW9jaygpKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKHsgY29ycmVsYXRpb25JZCwgcGhvbmUgfSwgJ1tNT0NLXSBTZWFyY2hpbmcgY29udGFjdCBieSBwaG9uZSAoU2ltdWxhdGluZyBub3QgZm91bmQpJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSB0aGlzLm5vcm1hbGl6ZVBob25lKHBob25lKTtcclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oeyBjb3JyZWxhdGlvbklkLCBwaG9uZTogbm9ybWFsaXplZFBob25lIH0sICdTZWFyY2hpbmcgY29udGFjdCBieSBwaG9uZScpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNsaWVudC5nZXQoYC9jb250YWN0cy9gLCB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBHSExfTE9DQVRJT05fSUQsXHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnk6IG5vcm1hbGl6ZWRQaG9uZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhY3RzID0gcmVzcG9uc2UuZGF0YS5jb250YWN0cyB8fCBbXTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjb250YWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyh7IGNvcnJlbGF0aW9uSWQsIGNvbnRhY3RJZDogY29udGFjdHNbMF0uaWQgfSwgJ0NvbnRhY3QgZm91bmQgYnkgcGhvbmUnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb250YWN0c1swXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oeyBjb3JyZWxhdGlvbklkIH0sICdObyBjb250YWN0IGZvdW5kIGJ5IHBob25lJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKHsgY29ycmVsYXRpb25JZCwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgJ0Vycm9yIHNlYXJjaGluZyBjb250YWN0IGJ5IHBob25lJyk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHNlYXJjaCBjb250YWN0IGJ5IHBob25lJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIG5ldyBjb250YWN0IHdpdGggd2Vic2l0ZV9sZWFkIHRhZ1xyXG4gICAgICogQ1JJVElDQUw6IFRhZyBtdXN0IGJlIGluY2x1ZGVkIGluIGNyZWF0aW9uIHBheWxvYWQgZm9yIHdvcmtmbG93IHRyaWdnZXJcclxuICAgICAqL1xyXG4gICAgYXN5bmMgY3JlYXRlQ29udGFjdChkYXRhOiBDcmVhdGVDb250YWN0RGF0YSwgY29ycmVsYXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTxHSExDb250YWN0PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNNb2NrKCkpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oeyBjb3JyZWxhdGlvbklkLCBlbWFpbDogZGF0YS5lbWFpbCB9LCAnW01PQ0tdIENyZWF0aW5nIG5ldyBjb250YWN0IChTaW11bGF0aW5nIHN1Y2Nlc3MpJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpZDogJ21vY2stY29udGFjdC1pZC0nICsgRGF0ZS5ub3coKSxcclxuICAgICAgICAgICAgICAgIGVtYWlsOiBkYXRhLmVtYWlsLFxyXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiBkYXRhLmZpcnN0TmFtZSxcclxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBkYXRhLmxhc3ROYW1lLFxyXG4gICAgICAgICAgICAgICAgdGFnczogWyd3ZWJzaXRlX2xlYWQnXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSB0aGlzLm5vcm1hbGl6ZVBob25lKGRhdGEucGhvbmUpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcGF5bG9hZCA9IHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IEdITF9MT0NBVElPTl9JRCxcclxuICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogZGF0YS5maXJzdE5hbWUudHJpbSgpLFxyXG4gICAgICAgICAgICAgICAgbGFzdE5hbWU6IGRhdGEubGFzdE5hbWUudHJpbSgpLFxyXG4gICAgICAgICAgICAgICAgZW1haWw6IGRhdGEuZW1haWwudG9Mb3dlckNhc2UoKS50cmltKCksXHJcbiAgICAgICAgICAgICAgICBwaG9uZTogbm9ybWFsaXplZFBob25lLFxyXG4gICAgICAgICAgICAgICAgdGFnczogWyd3ZWJzaXRlX2xlYWQnXSwgLy8gQ1JJVElDQUw6IE11c3QgYmUgaW4gY3JlYXRpb24gcGF5bG9hZFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tRmllbGRzOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgeyBpZDogJ3Bvc3Rjb2RlJywgdmFsdWU6IGRhdGEucG9zdGNvZGUgfSwgLy8gSW4gdjIsIGtleXMgYXJlIG9mdGVuIFVVSUQgSURzIG9yIHNwZWNpZmljIGtleXNcclxuICAgICAgICAgICAgICAgICAgICB7IGlkOiAnb2NjdXBhbmN5U3RhdHVzJywgdmFsdWU6IGRhdGEucXVpekRhdGEub2NjdXBhbmN5U3RhdHVzIHx8ICcnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgeyBpZDogJ2hlYXRpbmdUeXBlJywgdmFsdWU6IGRhdGEucXVpekRhdGEuaGVhdGluZ1R5cGUgfHwgJycgfSxcclxuICAgICAgICAgICAgICAgICAgICB7IGlkOiAncHJvZmVzc2lvbmFsU2l0dWF0aW9uJywgdmFsdWU6IGRhdGEucXVpekRhdGEucHJvZmVzc2lvbmFsU2l0dWF0aW9uIHx8ICcnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgeyBpZDogJ3NvdXJjZScsIHZhbHVlOiAnd2Vic2l0ZV9xdWl6JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHsgaWQ6ICdzdWJtaXNzaW9uRGF0ZScsIHZhbHVlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfVxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oeyBjb3JyZWxhdGlvbklkLCBlbWFpbDogcGF5bG9hZC5lbWFpbCB9LCAnQ3JlYXRpbmcgbmV3IGNvbnRhY3Qgd2l0aCB3ZWJzaXRlX2xlYWQgdGFnIChBUEkgdjIpJyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2xpZW50LnBvc3QoJy9jb250YWN0cy8nLCBwYXlsb2FkKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhY3QgPSByZXNwb25zZS5kYXRhLmNvbnRhY3Q7XHJcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKHsgY29ycmVsYXRpb25JZCwgY29udGFjdElkOiBjb250YWN0LmlkIH0sICdDb250YWN0IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY29udGFjdDtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcih7XHJcbiAgICAgICAgICAgICAgICBjb3JyZWxhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICByZXNwb25zZTogZXJyb3IucmVzcG9uc2U/LmRhdGFcclxuICAgICAgICAgICAgfSwgJ0Vycm9yIGNyZWF0aW5nIGNvbnRhY3QnKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGNvbnRhY3QgaW4gR29IaWdoTGV2ZWwnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBjb250YWN0IGV4aXN0cyAoZW1haWwgZmlyc3QsIHBob25lIGZhbGxiYWNrKVxyXG4gICAgICovXHJcbiAgICBhc3luYyBjb250YWN0RXhpc3RzKGVtYWlsOiBzdHJpbmcsIHBob25lOiBzdHJpbmcsIGNvcnJlbGF0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8R0hMQ29udGFjdCB8IG51bGw+IHtcclxuICAgICAgICAvLyBUcnkgZW1haWwgZmlyc3RcclxuICAgICAgICBjb25zdCBjb250YWN0QnlFbWFpbCA9IGF3YWl0IHRoaXMuc2VhcmNoQnlFbWFpbChlbWFpbCwgY29ycmVsYXRpb25JZCk7XHJcbiAgICAgICAgaWYgKGNvbnRhY3RCeUVtYWlsKSByZXR1cm4gY29udGFjdEJ5RW1haWw7XHJcblxyXG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIHBob25lXHJcbiAgICAgICAgY29uc3QgY29udGFjdEJ5UGhvbmUgPSBhd2FpdCB0aGlzLnNlYXJjaEJ5UGhvbmUocGhvbmUsIGNvcnJlbGF0aW9uSWQpO1xyXG4gICAgICAgIHJldHVybiBjb250YWN0QnlQaG9uZTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gU2luZ2xldG9uIGluc3RhbmNlXHJcbmNvbnN0IGdobFNlcnZpY2UgPSBuZXcgR29IaWdoTGV2ZWxTZXJ2aWNlKCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnaGxTZXJ2aWNlO1xyXG4iXSwibmFtZXMiOlsiYXhpb3MiLCJwYXJzZVBob25lTnVtYmVyIiwibG9nZ2VyIiwiR0hMX0FQSV9CQVNFX1VSTCIsInByb2Nlc3MiLCJlbnYiLCJHSExfQVBJX0tFWSIsIkdITF9MT0NBVElPTl9JRCIsIkdITF9BUElfVElNRU9VVCIsInBhcnNlSW50IiwiR0hMX01PQ0tfTU9ERSIsIkdvSGlnaExldmVsU2VydmljZSIsImNvbnN0cnVjdG9yIiwiY2xpZW50IiwiY3JlYXRlIiwiYmFzZVVSTCIsInRpbWVvdXQiLCJoZWFkZXJzIiwiaXNNb2NrIiwibm9ybWFsaXplUGhvbmUiLCJwaG9uZSIsImRlZmF1bHRDb3VudHJ5IiwiY2xlYW5lZCIsInJlcGxhY2UiLCJwaG9uZU51bWJlciIsImlzVmFsaWQiLCJmb3JtYXQiLCJlcnJvciIsIndhcm4iLCJzZWFyY2hCeUVtYWlsIiwiZW1haWwiLCJjb3JyZWxhdGlvbklkIiwiaW5mbyIsInJlc3BvbnNlIiwiZ2V0IiwicGFyYW1zIiwibG9jYXRpb25JZCIsInRvTG93ZXJDYXNlIiwidHJpbSIsImNvbnRhY3RzIiwiZGF0YSIsImxlbmd0aCIsImNvbnRhY3RJZCIsImlkIiwibWVzc2FnZSIsIkVycm9yIiwic2VhcmNoQnlQaG9uZSIsIm5vcm1hbGl6ZWRQaG9uZSIsInF1ZXJ5IiwiY3JlYXRlQ29udGFjdCIsIkRhdGUiLCJub3ciLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInRhZ3MiLCJwYXlsb2FkIiwiY3VzdG9tRmllbGRzIiwidmFsdWUiLCJwb3N0Y29kZSIsInF1aXpEYXRhIiwib2NjdXBhbmN5U3RhdHVzIiwiaGVhdGluZ1R5cGUiLCJwcm9mZXNzaW9uYWxTaXR1YXRpb24iLCJ0b0lTT1N0cmluZyIsInBvc3QiLCJjb250YWN0IiwiY29udGFjdEV4aXN0cyIsImNvbnRhY3RCeUVtYWlsIiwiY29udGFjdEJ5UGhvbmUiLCJnaGxTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/ghlService.ts\n");

/***/ }),

/***/ "(rsc)/./lib/logger.ts":
/*!***********************!*\
  !*** ./lib/logger.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var pino__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pino */ \"(rsc)/./node_modules/pino/pino.js\");\n/* harmony import */ var pino__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pino__WEBPACK_IMPORTED_MODULE_0__);\n\nconst logger = pino__WEBPACK_IMPORTED_MODULE_0___default()({\n    level:  false ? 0 : \"debug\",\n    base: {\n        env: \"development\"\n    },\n    // Never log sensitive data\n    redact: {\n        paths: [\n            \"req.headers.authorization\",\n            \"*.apiKey\",\n            \"*.password\",\n            \"*.token\"\n        ],\n        remove: true\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (logger);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF3QjtBQUV4QixNQUFNQyxTQUFTRCwyQ0FBSUEsQ0FBQztJQUNoQkUsT0FBT0MsTUFBeUIsR0FBZSxJQUFTO0lBQ3hEQyxNQUFNO1FBQ0ZDLEtBTFI7SUFNSTtJQUNBLDJCQUEyQjtJQUMzQkMsUUFBUTtRQUNKQyxPQUFPO1lBQUM7WUFBNkI7WUFBWTtZQUFjO1NBQVU7UUFDekVDLFFBQVE7SUFDWjtBQUNKO0FBRUEsaUVBQWVQLE1BQU1BLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbGlnbmVkLWNoaXJvLS0tbmV4dGdlbi1hc3Nlc3NtZW50Ly4vbGliL2xvZ2dlci50cz9mZDVkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwaW5vIGZyb20gJ3Bpbm8nO1xyXG5cclxuY29uc3QgbG9nZ2VyID0gcGlubyh7XHJcbiAgICBsZXZlbDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdpbmZvJyA6ICdkZWJ1ZycsXHJcbiAgICBiYXNlOiB7XHJcbiAgICAgICAgZW52OiBwcm9jZXNzLmVudi5OT0RFX0VOVixcclxuICAgIH0sXHJcbiAgICAvLyBOZXZlciBsb2cgc2Vuc2l0aXZlIGRhdGFcclxuICAgIHJlZGFjdDoge1xyXG4gICAgICAgIHBhdGhzOiBbJ3JlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24nLCAnKi5hcGlLZXknLCAnKi5wYXNzd29yZCcsICcqLnRva2VuJ10sXHJcbiAgICAgICAgcmVtb3ZlOiB0cnVlXHJcbiAgICB9XHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgbG9nZ2VyO1xyXG4iXSwibmFtZXMiOlsicGlubyIsImxvZ2dlciIsImxldmVsIiwicHJvY2VzcyIsImJhc2UiLCJlbnYiLCJyZWRhY3QiLCJwYXRocyIsInJlbW92ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/logger.ts\n");

/***/ }),

/***/ "(rsc)/./lib/rateLimiter.ts":
/*!****************************!*\
  !*** ./lib/rateLimiter.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass RateLimiter {\n    constructor(){\n        this.ipLimits = new Map();\n        this.emailLimits = new Map();\n        this.maxEntries = 10000 // Prevent memory overflow\n        ;\n        this.maxRequestsPerIP = parseInt(process.env.RATE_LIMIT_MAX_REQUESTS_PER_IP || \"5\");\n        this.windowMinutesIP = parseInt(process.env.RATE_LIMIT_WINDOW_MINUTES || \"15\");\n        this.maxRequestsPerEmail = parseInt(process.env.RATE_LIMIT_MAX_REQUESTS_PER_EMAIL || \"10\");\n        this.windowHoursEmail = parseInt(process.env.RATE_LIMIT_EMAIL_WINDOW_HOURS || \"1\");\n        // Cleanup expired entries every 5 minutes\n        setInterval(()=>this.cleanup(), 5 * 60 * 1000);\n    }\n    cleanup() {\n        const now = Date.now();\n        // Clean IP limits\n        for (const [key, entry] of this.ipLimits.entries()){\n            if (entry.resetTime < now) {\n                this.ipLimits.delete(key);\n            }\n        }\n        // Clean email limits\n        for (const [key, entry] of this.emailLimits.entries()){\n            if (entry.resetTime < now) {\n                this.emailLimits.delete(key);\n            }\n        }\n        // If still too many entries, remove oldest (LRU-style)\n        if (this.ipLimits.size > this.maxEntries) {\n            const toDelete = Array.from(this.ipLimits.keys()).slice(0, this.ipLimits.size - this.maxEntries);\n            toDelete.forEach((key)=>this.ipLimits.delete(key));\n        }\n        if (this.emailLimits.size > this.maxEntries) {\n            const toDelete = Array.from(this.emailLimits.keys()).slice(0, this.emailLimits.size - this.maxEntries);\n            toDelete.forEach((key)=>this.emailLimits.delete(key));\n        }\n    }\n    checkIPLimit(ip) {\n        const now = Date.now();\n        const entry = this.ipLimits.get(ip);\n        if (!entry || entry.resetTime < now) {\n            // New window\n            this.ipLimits.set(ip, {\n                count: 1,\n                resetTime: now + this.windowMinutesIP * 60 * 1000\n            });\n            return {\n                allowed: true\n            };\n        }\n        if (entry.count >= this.maxRequestsPerIP) {\n            const retryAfter = Math.ceil((entry.resetTime - now) / 1000);\n            return {\n                allowed: false,\n                retryAfter\n            };\n        }\n        entry.count++;\n        return {\n            allowed: true\n        };\n    }\n    checkEmailLimit(email) {\n        const now = Date.now();\n        const entry = this.emailLimits.get(email.toLowerCase());\n        if (!entry || entry.resetTime < now) {\n            // New window\n            this.emailLimits.set(email.toLowerCase(), {\n                count: 1,\n                resetTime: now + this.windowHoursEmail * 60 * 60 * 1000\n            });\n            return {\n                allowed: true\n            };\n        }\n        if (entry.count >= this.maxRequestsPerEmail) {\n            const retryAfter = Math.ceil((entry.resetTime - now) / 1000);\n            return {\n                allowed: false,\n                retryAfter\n            };\n        }\n        entry.count++;\n        return {\n            allowed: true\n        };\n    }\n}\n// Singleton instance\nconst rateLimiter = new RateLimiter();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (rateLimiter);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWFDLEtBQUtDLElBQUksQ0FBQyxDQUFDbkIsTUFBTUUsU0FBUyxHQUFHTCxHQUFFLElBQUs7WUFDdkQsT0FBTztnQkFBRW1CLFNBQVM7Z0JBQU9DO1lBQVc7UUFDeEM7UUFFQWpCLE1BQU1lLEtBQUs7UUFDWCxPQUFPO1lBQUVDLFNBQVM7UUFBSztJQUMzQjtJQUVBSSxnQkFBZ0JDLEtBQWEsRUFBNkM7UUFDdEUsTUFBTXhCLE1BQU1DLEtBQUtELEdBQUc7UUFDcEIsTUFBTUcsUUFBUSxJQUFJLENBQUNsQixXQUFXLENBQUMrQixHQUFHLENBQUNRLE1BQU1DLFdBQVc7UUFFcEQsSUFBSSxDQUFDdEIsU0FBU0EsTUFBTUUsU0FBUyxHQUFHTCxLQUFLO1lBQ2pDLGFBQWE7WUFDYixJQUFJLENBQUNmLFdBQVcsQ0FBQ2dDLEdBQUcsQ0FBQ08sTUFBTUMsV0FBVyxJQUFJO2dCQUN0Q1AsT0FBTztnQkFDUGIsV0FBV0wsTUFBTSxJQUFJLENBQUNKLGdCQUFnQixHQUFHLEtBQUssS0FBSztZQUN2RDtZQUNBLE9BQU87Z0JBQUV1QixTQUFTO1lBQUs7UUFDM0I7UUFFQSxJQUFJaEIsTUFBTWUsS0FBSyxJQUFJLElBQUksQ0FBQ3hCLG1CQUFtQixFQUFFO1lBQ3pDLE1BQU0wQixhQUFhQyxLQUFLQyxJQUFJLENBQUMsQ0FBQ25CLE1BQU1FLFNBQVMsR0FBR0wsR0FBRSxJQUFLO1lBQ3ZELE9BQU87Z0JBQUVtQixTQUFTO2dCQUFPQztZQUFXO1FBQ3hDO1FBRUFqQixNQUFNZSxLQUFLO1FBQ1gsT0FBTztZQUFFQyxTQUFTO1FBQUs7SUFDM0I7QUFDSjtBQUVBLHFCQUFxQjtBQUNyQixNQUFNTyxjQUFjLElBQUk3QztBQUV4QixpRUFBZTZDLFdBQVdBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbGlnbmVkLWNoaXJvLS0tbmV4dGdlbi1hc3Nlc3NtZW50Ly4vbGliL3JhdGVMaW1pdGVyLnRzPzI5MmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbmFub2lkIH0gZnJvbSAnbmFub2lkJztcclxuXHJcbmludGVyZmFjZSBSYXRlTGltaXRFbnRyeSB7XHJcbiAgICBjb3VudDogbnVtYmVyO1xyXG4gICAgcmVzZXRUaW1lOiBudW1iZXI7XHJcbn1cclxuXHJcbmNsYXNzIFJhdGVMaW1pdGVyIHtcclxuICAgIHByaXZhdGUgaXBMaW1pdHM6IE1hcDxzdHJpbmcsIFJhdGVMaW1pdEVudHJ5PiA9IG5ldyBNYXAoKTtcclxuICAgIHByaXZhdGUgZW1haWxMaW1pdHM6IE1hcDxzdHJpbmcsIFJhdGVMaW1pdEVudHJ5PiA9IG5ldyBNYXAoKTtcclxuICAgIHByaXZhdGUgbWF4RW50cmllcyA9IDEwMDAwOyAvLyBQcmV2ZW50IG1lbW9yeSBvdmVyZmxvd1xyXG5cclxuICAgIHByaXZhdGUgbWF4UmVxdWVzdHNQZXJJUDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSB3aW5kb3dNaW51dGVzSVA6IG51bWJlcjtcclxuICAgIHByaXZhdGUgbWF4UmVxdWVzdHNQZXJFbWFpbDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSB3aW5kb3dIb3Vyc0VtYWlsOiBudW1iZXI7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5tYXhSZXF1ZXN0c1BlcklQID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkFURV9MSU1JVF9NQVhfUkVRVUVTVFNfUEVSX0lQIHx8ICc1Jyk7XHJcbiAgICAgICAgdGhpcy53aW5kb3dNaW51dGVzSVAgPSBwYXJzZUludChwcm9jZXNzLmVudi5SQVRFX0xJTUlUX1dJTkRPV19NSU5VVEVTIHx8ICcxNScpO1xyXG4gICAgICAgIHRoaXMubWF4UmVxdWVzdHNQZXJFbWFpbCA9IHBhcnNlSW50KHByb2Nlc3MuZW52LlJBVEVfTElNSVRfTUFYX1JFUVVFU1RTX1BFUl9FTUFJTCB8fCAnMTAnKTtcclxuICAgICAgICB0aGlzLndpbmRvd0hvdXJzRW1haWwgPSBwYXJzZUludChwcm9jZXNzLmVudi5SQVRFX0xJTUlUX0VNQUlMX1dJTkRPV19IT1VSUyB8fCAnMScpO1xyXG5cclxuICAgICAgICAvLyBDbGVhbnVwIGV4cGlyZWQgZW50cmllcyBldmVyeSA1IG1pbnV0ZXNcclxuICAgICAgICBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzLmNsZWFudXAoKSwgNSAqIDYwICogMTAwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhbnVwKCkge1xyXG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAgIC8vIENsZWFuIElQIGxpbWl0c1xyXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIHRoaXMuaXBMaW1pdHMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGlmIChlbnRyeS5yZXNldFRpbWUgPCBub3cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXBMaW1pdHMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENsZWFuIGVtYWlsIGxpbWl0c1xyXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIHRoaXMuZW1haWxMaW1pdHMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGlmIChlbnRyeS5yZXNldFRpbWUgPCBub3cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1haWxMaW1pdHMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIElmIHN0aWxsIHRvbyBtYW55IGVudHJpZXMsIHJlbW92ZSBvbGRlc3QgKExSVS1zdHlsZSlcclxuICAgICAgICBpZiAodGhpcy5pcExpbWl0cy5zaXplID4gdGhpcy5tYXhFbnRyaWVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvRGVsZXRlID0gQXJyYXkuZnJvbSh0aGlzLmlwTGltaXRzLmtleXMoKSkuc2xpY2UoMCwgdGhpcy5pcExpbWl0cy5zaXplIC0gdGhpcy5tYXhFbnRyaWVzKTtcclxuICAgICAgICAgICAgdG9EZWxldGUuZm9yRWFjaChrZXkgPT4gdGhpcy5pcExpbWl0cy5kZWxldGUoa2V5KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5lbWFpbExpbWl0cy5zaXplID4gdGhpcy5tYXhFbnRyaWVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvRGVsZXRlID0gQXJyYXkuZnJvbSh0aGlzLmVtYWlsTGltaXRzLmtleXMoKSkuc2xpY2UoMCwgdGhpcy5lbWFpbExpbWl0cy5zaXplIC0gdGhpcy5tYXhFbnRyaWVzKTtcclxuICAgICAgICAgICAgdG9EZWxldGUuZm9yRWFjaChrZXkgPT4gdGhpcy5lbWFpbExpbWl0cy5kZWxldGUoa2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrSVBMaW1pdChpcDogc3RyaW5nKTogeyBhbGxvd2VkOiBib29sZWFuOyByZXRyeUFmdGVyPzogbnVtYmVyIH0ge1xyXG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgY29uc3QgZW50cnkgPSB0aGlzLmlwTGltaXRzLmdldChpcCk7XHJcblxyXG4gICAgICAgIGlmICghZW50cnkgfHwgZW50cnkucmVzZXRUaW1lIDwgbm93KSB7XHJcbiAgICAgICAgICAgIC8vIE5ldyB3aW5kb3dcclxuICAgICAgICAgICAgdGhpcy5pcExpbWl0cy5zZXQoaXAsIHtcclxuICAgICAgICAgICAgICAgIGNvdW50OiAxLFxyXG4gICAgICAgICAgICAgICAgcmVzZXRUaW1lOiBub3cgKyB0aGlzLndpbmRvd01pbnV0ZXNJUCAqIDYwICogMTAwMFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGVudHJ5LmNvdW50ID49IHRoaXMubWF4UmVxdWVzdHNQZXJJUCkge1xyXG4gICAgICAgICAgICBjb25zdCByZXRyeUFmdGVyID0gTWF0aC5jZWlsKChlbnRyeS5yZXNldFRpbWUgLSBub3cpIC8gMTAwMCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGFsbG93ZWQ6IGZhbHNlLCByZXRyeUFmdGVyIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbnRyeS5jb3VudCsrO1xyXG4gICAgICAgIHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja0VtYWlsTGltaXQoZW1haWw6IHN0cmluZyk6IHsgYWxsb3dlZDogYm9vbGVhbjsgcmV0cnlBZnRlcj86IG51bWJlciB9IHtcclxuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5lbWFpbExpbWl0cy5nZXQoZW1haWwudG9Mb3dlckNhc2UoKSk7XHJcblxyXG4gICAgICAgIGlmICghZW50cnkgfHwgZW50cnkucmVzZXRUaW1lIDwgbm93KSB7XHJcbiAgICAgICAgICAgIC8vIE5ldyB3aW5kb3dcclxuICAgICAgICAgICAgdGhpcy5lbWFpbExpbWl0cy5zZXQoZW1haWwudG9Mb3dlckNhc2UoKSwge1xyXG4gICAgICAgICAgICAgICAgY291bnQ6IDEsXHJcbiAgICAgICAgICAgICAgICByZXNldFRpbWU6IG5vdyArIHRoaXMud2luZG93SG91cnNFbWFpbCAqIDYwICogNjAgKiAxMDAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZW50cnkuY291bnQgPj0gdGhpcy5tYXhSZXF1ZXN0c1BlckVtYWlsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBNYXRoLmNlaWwoKGVudHJ5LnJlc2V0VGltZSAtIG5vdykgLyAxMDAwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogZmFsc2UsIHJldHJ5QWZ0ZXIgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVudHJ5LmNvdW50Kys7XHJcbiAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBTaW5nbGV0b24gaW5zdGFuY2VcclxuY29uc3QgcmF0ZUxpbWl0ZXIgPSBuZXcgUmF0ZUxpbWl0ZXIoKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJhdGVMaW1pdGVyO1xyXG4iXSwibmFtZXMiOlsiUmF0ZUxpbWl0ZXIiLCJjb25zdHJ1Y3RvciIsImlwTGltaXRzIiwiTWFwIiwiZW1haWxMaW1pdHMiLCJtYXhFbnRyaWVzIiwibWF4UmVxdWVzdHNQZXJJUCIsInBhcnNlSW50IiwicHJvY2VzcyIsImVudiIsIlJBVEVfTElNSVRfTUFYX1JFUVVFU1RTX1BFUl9JUCIsIndpbmRvd01pbnV0ZXNJUCIsIlJBVEVfTElNSVRfV0lORE9XX01JTlVURVMiLCJtYXhSZXF1ZXN0c1BlckVtYWlsIiwiUkFURV9MSU1JVF9NQVhfUkVRVUVTVFNfUEVSX0VNQUlMIiwid2luZG93SG91cnNFbWFpbCIsIlJBVEVfTElNSVRfRU1BSUxfV0lORE9XX0hPVVJTIiwic2V0SW50ZXJ2YWwiLCJjbGVhbnVwIiwibm93IiwiRGF0ZSIsImtleSIsImVudHJ5IiwiZW50cmllcyIsInJlc2V0VGltZSIsImRlbGV0ZSIsInNpemUiLCJ0b0RlbGV0ZSIsIkFycmF5IiwiZnJvbSIsImtleXMiLCJzbGljZSIsImZvckVhY2giLCJjaGVja0lQTGltaXQiLCJpcCIsImdldCIsInNldCIsImNvdW50IiwiYWxsb3dlZCIsInJldHJ5QWZ0ZXIiLCJNYXRoIiwiY2VpbCIsImNoZWNrRW1haWxMaW1pdCIsImVtYWlsIiwidG9Mb3dlckNhc2UiLCJyYXRlTGltaXRlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/rateLimiter.ts\n");

/***/ }),

/***/ "(rsc)/./lib/requestSigner.ts":
/*!******************************!*\
  !*** ./lib/requestSigner.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateSignature: () => (/* binding */ generateSignature),\n/* harmony export */   signRequest: () => (/* binding */ signRequest),\n/* harmony export */   verifyRequest: () => (/* binding */ verifyRequest),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction generateSignature(payload, secret) {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", secret).update(payload).digest(\"hex\");\n}\nfunction verifySignature(payload, signature, secret) {\n    const expectedSignature = generateSignature(payload, secret);\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(Buffer.from(signature), Buffer.from(expectedSignature));\n}\nfunction signRequest(data) {\n    const timestamp = Date.now();\n    const payload = JSON.stringify({\n        ...data,\n        timestamp\n    });\n    const secret = process.env.REQUEST_SIGNING_SECRET || \"\";\n    return {\n        signature: generateSignature(payload, secret),\n        timestamp\n    };\n}\nfunction verifyRequest(data, signature, timestamp) {\n    const secret = process.env.REQUEST_SIGNING_SECRET || \"\";\n    // Check timestamp (reject if older than 5 minutes)\n    const now = Date.now();\n    const maxAge = 5 * 60 * 1000; // 5 minutes\n    if (now - timestamp > maxAge) {\n        return {\n            valid: false,\n            error: \"Request expired\"\n        };\n    }\n    if (timestamp > now + 60000) {\n        return {\n            valid: false,\n            error: \"Request timestamp in future\"\n        };\n    }\n    const payload = JSON.stringify({\n        ...data,\n        timestamp\n    });\n    try {\n        const isValid = verifySignature(payload, signature, secret);\n        return {\n            valid: isValid,\n            error: isValid ? undefined : \"Invalid signature\"\n        };\n    } catch (error) {\n        return {\n            valid: false,\n            error: \"Signature verification failed\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcmVxdWVzdFNpZ25lci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBNEI7QUFFckIsU0FBU0Msa0JBQWtCQyxPQUFlLEVBQUVDLE1BQWM7SUFDN0QsT0FBT0gsd0RBQ1EsQ0FBQyxVQUFVRyxRQUNyQkUsTUFBTSxDQUFDSCxTQUNQSSxNQUFNLENBQUM7QUFDaEI7QUFFTyxTQUFTQyxnQkFDWkwsT0FBZSxFQUNmTSxTQUFpQixFQUNqQkwsTUFBYztJQUVkLE1BQU1NLG9CQUFvQlIsa0JBQWtCQyxTQUFTQztJQUNyRCxPQUFPSCw2REFBc0IsQ0FDekJXLE9BQU9DLElBQUksQ0FBQ0osWUFDWkcsT0FBT0MsSUFBSSxDQUFDSDtBQUVwQjtBQUVPLFNBQVNJLFlBQVlDLElBQVM7SUFDakMsTUFBTUMsWUFBWUMsS0FBS0MsR0FBRztJQUMxQixNQUFNZixVQUFVZ0IsS0FBS0MsU0FBUyxDQUFDO1FBQUUsR0FBR0wsSUFBSTtRQUFFQztJQUFVO0lBQ3BELE1BQU1aLFNBQVNpQixRQUFRQyxHQUFHLENBQUNDLHNCQUFzQixJQUFJO0lBRXJELE9BQU87UUFDSGQsV0FBV1Asa0JBQWtCQyxTQUFTQztRQUN0Q1k7SUFDSjtBQUNKO0FBRU8sU0FBU1EsY0FDWlQsSUFBUyxFQUNUTixTQUFpQixFQUNqQk8sU0FBaUI7SUFFakIsTUFBTVosU0FBU2lCLFFBQVFDLEdBQUcsQ0FBQ0Msc0JBQXNCLElBQUk7SUFFckQsbURBQW1EO0lBQ25ELE1BQU1MLE1BQU1ELEtBQUtDLEdBQUc7SUFDcEIsTUFBTU8sU0FBUyxJQUFJLEtBQUssTUFBTSxZQUFZO0lBRTFDLElBQUlQLE1BQU1GLFlBQVlTLFFBQVE7UUFDMUIsT0FBTztZQUFFQyxPQUFPO1lBQU9DLE9BQU87UUFBa0I7SUFDcEQ7SUFFQSxJQUFJWCxZQUFZRSxNQUFNLE9BQU87UUFDekIsT0FBTztZQUFFUSxPQUFPO1lBQU9DLE9BQU87UUFBOEI7SUFDaEU7SUFFQSxNQUFNeEIsVUFBVWdCLEtBQUtDLFNBQVMsQ0FBQztRQUFFLEdBQUdMLElBQUk7UUFBRUM7SUFBVTtJQUVwRCxJQUFJO1FBQ0EsTUFBTVksVUFBVXBCLGdCQUFnQkwsU0FBU00sV0FBV0w7UUFDcEQsT0FBTztZQUFFc0IsT0FBT0U7WUFBU0QsT0FBT0MsVUFBVUMsWUFBWTtRQUFvQjtJQUM5RSxFQUFFLE9BQU9GLE9BQU87UUFDWixPQUFPO1lBQUVELE9BQU87WUFBT0MsT0FBTztRQUFnQztJQUNsRTtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWxpZ25lZC1jaGlyby0tLW5leHRnZW4tYXNzZXNzbWVudC8uL2xpYi9yZXF1ZXN0U2lnbmVyLnRzPzdkNWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlU2lnbmF0dXJlKHBheWxvYWQ6IHN0cmluZywgc2VjcmV0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGNyeXB0b1xyXG4gICAgICAgIC5jcmVhdGVIbWFjKCdzaGEyNTYnLCBzZWNyZXQpXHJcbiAgICAgICAgLnVwZGF0ZShwYXlsb2FkKVxyXG4gICAgICAgIC5kaWdlc3QoJ2hleCcpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5U2lnbmF0dXJlKFxyXG4gICAgcGF5bG9hZDogc3RyaW5nLFxyXG4gICAgc2lnbmF0dXJlOiBzdHJpbmcsXHJcbiAgICBzZWNyZXQ6IHN0cmluZ1xyXG4pOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gZ2VuZXJhdGVTaWduYXR1cmUocGF5bG9hZCwgc2VjcmV0KTtcclxuICAgIHJldHVybiBjcnlwdG8udGltaW5nU2FmZUVxdWFsKFxyXG4gICAgICAgIEJ1ZmZlci5mcm9tKHNpZ25hdHVyZSksXHJcbiAgICAgICAgQnVmZmVyLmZyb20oZXhwZWN0ZWRTaWduYXR1cmUpXHJcbiAgICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2lnblJlcXVlc3QoZGF0YTogYW55KTogeyBzaWduYXR1cmU6IHN0cmluZzsgdGltZXN0YW1wOiBudW1iZXIgfSB7XHJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QgcGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KHsgLi4uZGF0YSwgdGltZXN0YW1wIH0pO1xyXG4gICAgY29uc3Qgc2VjcmV0ID0gcHJvY2Vzcy5lbnYuUkVRVUVTVF9TSUdOSU5HX1NFQ1JFVCB8fCAnJztcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHNpZ25hdHVyZTogZ2VuZXJhdGVTaWduYXR1cmUocGF5bG9hZCwgc2VjcmV0KSxcclxuICAgICAgICB0aW1lc3RhbXBcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlSZXF1ZXN0KFxyXG4gICAgZGF0YTogYW55LFxyXG4gICAgc2lnbmF0dXJlOiBzdHJpbmcsXHJcbiAgICB0aW1lc3RhbXA6IG51bWJlclxyXG4pOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcclxuICAgIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LlJFUVVFU1RfU0lHTklOR19TRUNSRVQgfHwgJyc7XHJcblxyXG4gICAgLy8gQ2hlY2sgdGltZXN0YW1wIChyZWplY3QgaWYgb2xkZXIgdGhhbiA1IG1pbnV0ZXMpXHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QgbWF4QWdlID0gNSAqIDYwICogMTAwMDsgLy8gNSBtaW51dGVzXHJcblxyXG4gICAgaWYgKG5vdyAtIHRpbWVzdGFtcCA+IG1heEFnZSkge1xyXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdSZXF1ZXN0IGV4cGlyZWQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRpbWVzdGFtcCA+IG5vdyArIDYwMDAwKSB7IC8vIEFsbG93IDEgbWludXRlIGNsb2NrIHNrZXdcclxuICAgICAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yOiAnUmVxdWVzdCB0aW1lc3RhbXAgaW4gZnV0dXJlJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnN0cmluZ2lmeSh7IC4uLmRhdGEsIHRpbWVzdGFtcCB9KTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGlzVmFsaWQgPSB2ZXJpZnlTaWduYXR1cmUocGF5bG9hZCwgc2lnbmF0dXJlLCBzZWNyZXQpO1xyXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiBpc1ZhbGlkLCBlcnJvcjogaXNWYWxpZCA/IHVuZGVmaW5lZCA6ICdJbnZhbGlkIHNpZ25hdHVyZScgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IGZhbHNlLCBlcnJvcjogJ1NpZ25hdHVyZSB2ZXJpZmljYXRpb24gZmFpbGVkJyB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjcnlwdG8iLCJnZW5lcmF0ZVNpZ25hdHVyZSIsInBheWxvYWQiLCJzZWNyZXQiLCJjcmVhdGVIbWFjIiwidXBkYXRlIiwiZGlnZXN0IiwidmVyaWZ5U2lnbmF0dXJlIiwic2lnbmF0dXJlIiwiZXhwZWN0ZWRTaWduYXR1cmUiLCJ0aW1pbmdTYWZlRXF1YWwiLCJCdWZmZXIiLCJmcm9tIiwic2lnblJlcXVlc3QiLCJkYXRhIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm9jZXNzIiwiZW52IiwiUkVRVUVTVF9TSUdOSU5HX1NFQ1JFVCIsInZlcmlmeVJlcXVlc3QiLCJtYXhBZ2UiLCJ2YWxpZCIsImVycm9yIiwiaXNWYWxpZCIsInVuZGVmaW5lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/requestSigner.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/axios","vendor-chunks/libphonenumber-js","vendor-chunks/pino","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/zod","vendor-chunks/pino-std-serializers","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/thread-stream","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/nanoid","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/sonic-boom","vendor-chunks/supports-color","vendor-chunks/safe-stable-stringify","vendor-chunks/quick-format-unescaped","vendor-chunks/proxy-from-env","vendor-chunks/on-exit-leak-free","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/isomorphic-dompurify","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/dompurify","vendor-chunks/delayed-stream","vendor-chunks/combined-stream","vendor-chunks/atomic-sleep","vendor-chunks/@pinojs"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fghl-contact%2Froute&page=%2Fapi%2Fghl-contact%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fghl-contact%2Froute.ts&appDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C20015%5CDownloads%5Caligned-chiro---nextgen-assessment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();